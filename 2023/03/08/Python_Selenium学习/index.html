<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Charmersix">
    
    <title>
        
            Python_Selenium_Study |
        
        Charmersix&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/head.png">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"charmersix.icu","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/logo.png","favicon":"/images/head.png","avatar":"/images/ta.jpg","font_size":null,"font_family":null,"hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","font_color":null,"hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":true,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":"https://lsvf4zhg.api.lncldglobal.com","reaction":true,"version":2}},"post":{"author_label":{"enable":false,"auto":false,"custom_label_list":["CTFer"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"left","copyright_info":false},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original article title","author":"Original article author","link":"Original article link"}
  </script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/logo.png">
                </a>
            
            <a class="logo-title" href="/">
               Charmersix&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/link"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/link">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">Python_Selenium_Study</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/ta.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Charmersix</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-03-08 00:00:00</span>
        <span class="mobile">2023-03-08 00:00</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2023-04-09 16:35:15</span>
    </span>
    
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/python/">python</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Study/">Study</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Selenium/">Selenium</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>9.7k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>41 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <p>在一切的开始,先感谢白月黑羽师傅</p>
<p>这是师傅的<a class="link"   target="_blank" rel="noopener" href="https://www.byhy.net/" >blog<i class="fas fa-external-link-alt"></i></a>:<a class="link"   target="_blank" rel="noopener" href="https://www.byhy.net/" >https://www.byhy.net/<i class="fas fa-external-link-alt"></i></a></p>
<p>这是师傅的<a class="link"   target="_blank" rel="noopener" href="https://space.bilibili.com/401981380" >B站<i class="fas fa-external-link-alt"></i></a>:<a class="link"   target="_blank" rel="noopener" href="https://space.bilibili.com/401981380" >https://space.bilibili.com/401981380<i class="fas fa-external-link-alt"></i></a></p>
<p>推荐大家去看白月黑羽师傅的原文和视频这篇只是个人笔记</p>
<h3 id="selenium原理"><a href="#selenium原理" class="headerlink" title="selenium原理"></a>selenium原理</h3><p><code>selenium自动化程序+浏览器驱动(转发指令)控制浏览器</code></p>
<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><p>首先安装python, 这里不再赘述,然后安装selenium库</p>
<p><code>pip install selenium</code></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301032053901.png"
                      alt="image-20230103205327525"
                ></p>
<p>安装<a class="link"   target="_blank" rel="noopener" href="https://www.google.cn/chrome/" >chrome浏览器<i class="fas fa-external-link-alt"></i></a>及其<a class="link"   target="_blank" rel="noopener" href="https://chromedriver.storage.googleapis.com/index.html" >驱动<i class="fas fa-external-link-alt"></i></a></p>
<p>或者是可以选择<a class="link"   target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/edge/home?form=MA13FJ" >edge浏览器<i class="fas fa-external-link-alt"></i></a>及其<a class="link"   target="_blank" rel="noopener" href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/" >驱动<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="简单实例"><a href="#简单实例" class="headerlink" title="简单实例"></a>简单实例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line">wd = webdriver.Chrome(service = Service(<span class="string">r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;</span>))</span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://charmersix.icu&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line"><span class="built_in">input</span>()</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301032128378.png"
                      alt="image-20230103212859271"
                ></p>
<p>当然我们可以将chromedriver加一个环境变量,就可以不在代码里点明路径</p>
<p>like this</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://charmersix.icu&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line"><span class="built_in">input</span>()</span><br></pre></td></tr></table></figure>

<h3 id="选择元素的基本方法"><a href="#选择元素的基本方法" class="headerlink" title="选择元素的基本方法"></a>选择元素的基本方法</h3><p>可以通过元素的id选择,但是这个id必须是当前页面唯一的,如果不确定是否是唯一的,可以通过搜索功能试一下</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301042027630.png"
                      alt="image-20230104202735545"
                ></p>
<p>可以看一下这里虽然搜出来了九个,实际上<code>id=&quot;kw&quot;</code>只有一个</p>
<p>我们就可以通过实例实现一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">element = wd.find_element(By.ID,<span class="string">&#x27;kw&#x27;</span>)</span><br><span class="line"><span class="comment">#根据id选择元素，返回的就是该元素对应的webelement对象</span></span><br><span class="line">element.send_keys(<span class="string">&#x27;Charmersix\n&#x27;</span>)</span><br><span class="line"><span class="comment">#在输入框中输入字符串，并且回车搜索</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301051904315.png"
                      alt="image-20230105190433178"
                ></p>
<p>bing也是一样<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301051958594.png"
                      alt="image-20230105195830508"
                ></p>
<p>上边栗子采用的回车搜索,如果我们回车无法搜索需要点击的话,我们可以用<code>click</code>方法,还是通过id筛选搜索元素去点击这个元素<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301052050068.png"
                      alt="image-20230105205027865"
                ></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cn.bing.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line"></span><br><span class="line">element = wd.find_element(By.ID,<span class="string">&#x27;sb_form_q&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#根据id选择元素，返回的就是该元素对应的webelement对象</span></span><br><span class="line">element.send_keys(<span class="string">&#x27;Charmersix&#x27;</span>)</span><br><span class="line"><span class="comment">#在输入框中输入字符串，并且回车搜索</span></span><br><span class="line">search = wd.find_element(By.ID,<span class="string">&#x27;search_icon&#x27;</span>)</span><br><span class="line">search.click()</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301052047277.png"
                      alt="image-20230105204717196"
                ></p>
<p>如果我们想要筛选的这个元素、标签里没有id,我们也是可以根据其他方法来选择的,比方说<code>class</code>属性或者是<code>标签名</code></p>
<p>这里借用一下<a class="link"   target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/sample1.html" >白月黑羽师傅的网站<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line"></span><br><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;animal&#x27;</span>)</span><br><span class="line"><span class="comment">#这里换用了elements, 如果是element只能选择出第一个元素, 而elements可以将三个都选出来</span></span><br><span class="line"><span class="comment">#根据class name选择元素，返回一个列表</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br><span class="line"><span class="comment">#将筛选的内容打印出来</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301062112461.png"
                      alt="image-20230106211209375"
                ></p>
<p>根据标签名也是一样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line"></span><br><span class="line">elements = wd.find_elements(By.TAG_NAME, <span class="string">&#x27;span&#x27;</span>)</span><br><span class="line"><span class="comment">#根据标签选择元素，返回一个列表</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br><span class="line"><span class="comment">#将筛选的内容打印出来</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301062123392.png"
                      alt="image-20230106212307302"
                ></p>
<p>WebDriver对象选择元素的范围是整个web页面，而WebElement对象选择的范围是元素内部，简而言之就是我们可以通过套娃方法选择到更具体的、更精确的信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">elements = wd.find_element(By.ID, <span class="string">&#x27;container&#x27;</span>)</span><br><span class="line"><span class="comment">#通过id选择特定元素</span></span><br><span class="line">spans = elements.find_elements(By.TAG_NAME, <span class="string">&#x27;span&#x27;</span>)</span><br><span class="line"><span class="comment">#根据标签选择元素，返回一个列表</span></span><br><span class="line"><span class="keyword">for</span> span <span class="keyword">in</span> spans:</span><br><span class="line">    <span class="built_in">print</span>(span.text)</span><br><span class="line"><span class="comment">#将筛选的内容打印出来</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301072135719.png"
                      alt="image-20230107213548595"
                ></p>
<h3 id="等待元素出现"><a href="#等待元素出现" class="headerlink" title="等待元素出现"></a>等待元素出现</h3><p>这个模块主要是用于搜索功能后再查找提取内容利用sleep</p>
<p>例如,我这里要提取出我从bing中搜出的关于<code>Charmersix</code>的网站</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cn.bing.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">elements = wd.find_element(By.ID, <span class="string">&#x27;sb_form_q&#x27;</span>)</span><br><span class="line"><span class="comment">#通过id选择特定元素</span></span><br><span class="line">elements.send_keys(<span class="string">&#x27;Charmersix&#x27;</span>)</span><br><span class="line">search = wd.find_element(By.ID, <span class="string">&#x27;search_icon&#x27;</span>)</span><br><span class="line">search.click()</span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"><span class="comment">#给网站一个反应的时间，然后继续提取想要的内容</span></span><br><span class="line">cites = wd.find_elements(By.TAG_NAME, <span class="string">&#x27;cite&#x27;</span>)</span><br><span class="line"><span class="comment">#根据标签选择元素，返回一个列表</span></span><br><span class="line"><span class="keyword">for</span> cite <span class="keyword">in</span> cites:</span><br><span class="line">    <span class="built_in">print</span>(cite.text)</span><br><span class="line"><span class="comment">#将筛选的内容打印出来</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301092203036.png"
                      alt="image-20230109220331888"
                ></p>
<p>这里的<code>sleep(5)</code>比较长, 那么我们怎么确定具体的时间是多少, 睡多长时间最有效率呢, 我们可以使用<code>selenium</code>给我们提供的<code>隐式等待</code>也就是<code>implicitly_wait()</code>其原理是:当发现元素没有找到的时候,并不立即返回找不到的报错, 而是每隔半秒钟重新寻找, 在规定时间内直到找到该元素, 如果超出规定时间才会抛异常, <code>()</code>填的数字就是我们所规定的最大等待时间.也可以用一串代码来解释这个<code>implicitly_wait()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cites = wd.find_elements(By.TAG_NAME, <span class="string">&#x27;cite&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> cite <span class="keyword">in</span> cites:</span><br><span class="line">            <span class="built_in">print</span>(cite.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301092252358.png"
                      alt="image-20230109225201273"
                ></p>
<p>再来使用<code>implicitly_wait()</code>也可以达到同样的效果,但是代码会简化很多,这也就是python的强大之处</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cn.bing.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">elements = wd.find_element(By.ID, <span class="string">&#x27;sb_form_q&#x27;</span>)</span><br><span class="line"><span class="comment">#通过id选择特定元素</span></span><br><span class="line">elements.send_keys(<span class="string">&#x27;Charmersix&#x27;</span>)</span><br><span class="line">search = wd.find_element(By.ID, <span class="string">&#x27;search_icon&#x27;</span>)</span><br><span class="line">search.click()</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">cites = wd.find_elements(By.TAG_NAME, <span class="string">&#x27;cite&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> cite <span class="keyword">in</span> cites:</span><br><span class="line">    <span class="built_in">print</span>(cite.text)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202301092254852.png"
                      alt="image-20230109225411764"
                ></p>
<h3 id="操控元素"><a href="#操控元素" class="headerlink" title="操控元素"></a>操控元素</h3><h4 id="点击元素"><a href="#点击元素" class="headerlink" title="点击元素"></a>点击元素</h4><p>点击元素前面已经讲过就是调用webelement对象的click方法</p>
<p>这里要补充的是, 当我们调用webelement对象的click方法去点击的元素的时候, 浏览器接收到自动化命令, 点击的是该元素的中心点位置</p>
<p>但是当一些按钮的有效点击区域不在中间的时候, 我们就需要重新定位到有效点击区域</p>
<h4 id="输入框"><a href="#输入框" class="headerlink" title="输入框"></a>输入框</h4><p>前面也已经学过就是调用<code>send_keys</code>方法, 但是如果我们输入框中已经有内容了, 就需要先用一个<code>clear</code>方法, 将输入框中的内容清楚掉</p>
<p>我们试一下在原来的代码里加入两行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">elements.clear()</span><br><span class="line">elements.send_keys(<span class="string">&#x27;SkyMirror&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>我们会发现, 搜索框里的内容不再是Charmersix而是现在的SkyMirror<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222022644.png"
                      alt="image-20230222202226449"
                ></p>
<h4 id="获取元素信息"><a href="#获取元素信息" class="headerlink" title="获取元素信息"></a>获取元素信息</h4><h5 id="获取元素属性"><a href="#获取元素属性" class="headerlink" title="获取元素属性"></a>获取元素属性</h5><p>有一些关键信息可能不是文本形式, 有可能藏在元素的属性里, 比如说一些搜索框的提示语我们就可以使用<code>get_attribute</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://charmersix.icu/search/&#x27;</span>)</span><br><span class="line">elements = wd.find_element(By.TAG_NAME,<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">text = elements.get_attribute(<span class="string">&#x27;placeholder&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(text)</span><br></pre></td></tr></table></figure>

<p>像这样<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222041948.png"
                      alt="image-20230222204133867"
                ></p>
<h5 id="获取整个元素对应的HTML"><a href="#获取整个元素对应的HTML" class="headerlink" title="获取整个元素对应的HTML"></a>获取整个元素对应的HTML</h5><p>假如我们要提取大段的HTML内容, 我们可以使用<code>elements.get_attribute(&#39;innerHTML&#39;)</code>获取整个元素的HTML内容和<code>elements.get_attribute(&#39;outerHTML&#39;)</code>获取某元素内部的HTML内容<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222053389.png"
                      alt="image-20230222205353318"
                ><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222053373.png"
                      alt="image-20230222205330302"
                ></p>
<h5 id="获取输入框里的文字"><a href="#获取输入框里的文字" class="headerlink" title="获取输入框里的文字"></a>获取输入框里的文字</h5><p>对于输入框里的文本内容，用text属性是不行的，这时候可以使用<code>get_attribute(&#39;value&#39;)</code></p>
<p>比方说, 我们在上边代码里加入一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(elements.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222102903.png"
                      alt="image-20230222210257824"
                ></p>
<p>我们就能发现这里可以获取到我们输入的<code>Charmersix</code>内容</p>
<h5 id="获取元素文本内容"><a href="#获取元素文本内容" class="headerlink" title="获取元素文本内容"></a>获取元素文本内容</h5><p>通过<code>webelement</code>对象的text属性, 可以获取元素展示在界面上的文本内容, 但是有时候元素的文本内容没有显示在界面上或者没有完全展示在界面上. 这时候用text属性可能没办法正常获取文本内容, 出现这种问题尝试使用<code>element.get_attribute(&#39;innerText&#39;)</code>或者<code>element.get_attribute(&#39;textContent&#39;)</code></p>
<p>使用 innerText 和 textContent 的区别是，前者只显示元素可见文本内容，后者显示所有内容（包括display属性为none的部分）</p>
<blockquote>
<p>如果您了解web前端开发，可以知晓一下：</p>
<p>get_attribute 调用本质上就是调用 HTMLElement 对像的属性</p>
<p>比如</p>
<p>element.get_attribute(‘value’) 等价于js里面的 element.value</p>
<p>element.get_attribute(‘innerText’) 等价于js里面的 element.innerText</p>
</blockquote>
<h3 id="css表达式"><a href="#css表达式" class="headerlink" title="css表达式"></a>css表达式</h3><h3 id="CSS-选择器"><a href="#CSS-选择器" class="headerlink" title="CSS 选择器"></a><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/css_selectors.asp" >CSS 选择器<i class="fas fa-external-link-alt"></i></a></h3><p>在 CSS 中，选择器是选取需设置样式的元素的模式。</p>
<p>请使用我们的 CSS 选择器测试工具，它可为您演示不同的选择器。</p>
<table>
<thead>
<tr>
<th align="left">选择器</th>
<th align="left">例子</th>
<th align="left">例子描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_class.asp">.<em>class</em></a></td>
<td align="left">.intro</td>
<td align="left">选择 class=”intro” 的所有元素。</td>
</tr>
<tr>
<td align="left">.<em>class1</em>.<em>class2</em></td>
<td align="left">.name1.name2</td>
<td align="left">选择 class 属性中同时有 name1 和 name2 的所有元素。</td>
</tr>
<tr>
<td align="left">.<em>class1</em> .<em>class2</em></td>
<td align="left">.name1 .name2</td>
<td align="left">选择作为类名 name1 元素后代的所有类名 name2 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_id.asp">#<em>id</em></a></td>
<td align="left">#firstname</td>
<td align="left">选择 id=”firstname” 的元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_all.asp" >*<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">*</td>
<td align="left">选择所有元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_element.asp"><em>element</em></a></td>
<td align="left">p</td>
<td align="left">选择所有 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_element_class.asp"><em>element</em>.<em>class</em></a></td>
<td align="left">p.intro</td>
<td align="left">选择 class=”intro” 的所有 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_element_comma.asp"><em>element</em>,<em>element</em></a></td>
<td align="left">div, p</td>
<td align="left">选择所有 <code>&lt;div&gt;</code> 元素和所有 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_element_element.asp"><em>element</em> <em>element</em></a></td>
<td align="left">div p</td>
<td align="left">选择 <code>&lt;div&gt;</code> 元素内的所有 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_element_gt.asp"><em>element</em>&gt;<em>element</em></a></td>
<td align="left">div &gt; p</td>
<td align="left">选择父元素是 <code>&lt;div&gt;</code> 的所有 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_element_plus.asp"><em>element</em>+<em>element</em></a></td>
<td align="left">div + p</td>
<td align="left">选择紧跟 <code>&lt;div&gt;</code> 元素的首个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_gen_sibling.asp"><em>element1</em>~<em>element2</em></a></td>
<td align="left">p ~ ul</td>
<td align="left">选择前面有 <code>&lt;p&gt;</code> 元素的每个 <code>&lt;ul&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left">[<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_attribute.asp"><em>attribute</em>]</a></td>
<td align="left">[target]</td>
<td align="left">选择带有 target 属性的所有元素。</td>
</tr>
<tr>
<td align="left">[<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_attribute_value.asp"><em>attribute</em>=<em>value</em>]</a></td>
<td align="left">[target=_blank]</td>
<td align="left">选择带有 target=”_blank” 属性的所有元素。</td>
</tr>
<tr>
<td align="left">[<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_attribute_value_contain.asp"><em>attribute</em>~=<em>value</em>]</a></td>
<td align="left">[title~=flower]</td>
<td align="left">选择 title 属性包含单词 “flower” 的所有元素。</td>
</tr>
<tr>
<td align="left">[<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_attribute_value_start.asp"><em>attribute</em>|=<em>value</em>]</a></td>
<td align="left">[lang|=en]</td>
<td align="left">选择 lang 属性值以 “en” 开头的所有元素。</td>
</tr>
<tr>
<td align="left">[<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_attr_begin.asp"><em>attribute</em>^=<em>value</em>]</a></td>
<td align="left">a[href^=”https”]</td>
<td align="left">选择其 src 属性值以 “https” 开头的每个 <code>&lt;a&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left">[<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_attr_end.asp"><em>attribute</em>$=<em>value</em>]</a></td>
<td align="left">a[href$=”.pdf”]</td>
<td align="left">选择其 src 属性以 “.pdf” 结尾的所有 <code>&lt;a&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left">[<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_attr_contain.asp"><em>attribute</em>*=<em>value</em>]</a></td>
<td align="left">a[href*=”w3schools”]</td>
<td align="left">选择其 href 属性值中包含 “abc” 子串的每个 <code>&lt;a&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_active.asp" >:active<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">a:active</td>
<td align="left">选择活动链接。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_after.asp" >::after<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p::after</td>
<td align="left">在每个 <code>&lt;p&gt;</code> 的内容之后插入内容。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_before.asp" >::before<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p::before</td>
<td align="left">在每个 <code>&lt;p&gt;</code> 的内容之前插入内容。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_checked.asp" >:checked<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:checked</td>
<td align="left">选择每个被选中的 <code>&lt;input&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_default.asp" >:default<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:default</td>
<td align="left">选择默认的 <code>&lt;input&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_disabled.asp" >:disabled<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:disabled</td>
<td align="left">选择每个被禁用的 <code>&lt;input&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_empty.asp" >:empty<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p:empty</td>
<td align="left">选择没有子元素的每个 <code>&lt;p&gt;</code> 元素（包括文本节点）。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_enabled.asp" >:enabled<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:enabled</td>
<td align="left">选择每个启用的 <code>&lt;input&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_first-child.asp" >:first-child<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p:first-child</td>
<td align="left">选择属于父元素的第一个子元素的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_first-letter.asp" >::first-letter<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p::first-letter</td>
<td align="left">选择每个 <code>&lt;p&gt;</code> 元素的首字母。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_first-line.asp" >::first-line<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p::first-line</td>
<td align="left">选择每个 <code>&lt;p&gt;</code> 元素的首行。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_first-of-type.asp" >:first-of-type<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p:first-of-type</td>
<td align="left">选择属于其父元素的首个 <code>&lt;p&gt;</code> 元素的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_focus.asp" >:focus<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:focus</td>
<td align="left">选择获得焦点的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_fullscreen.asp" >:fullscreen<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">:fullscreen</td>
<td align="left">选择处于全屏模式的元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_hover.asp" >:hover<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">a:hover</td>
<td align="left">选择鼠标指针位于其上的链接。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_in-range.asp" >:in-range<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:in-range</td>
<td align="left">选择其值在指定范围内的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_indeterminate.asp" >:indeterminate<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:indeterminate</td>
<td align="left">选择处于不确定状态的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_invalid.asp" >:invalid<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:invalid</td>
<td align="left">选择具有无效值的所有 input 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_lang.asp">:lang(<em>language</em>)</a></td>
<td align="left">p:lang(it)</td>
<td align="left">选择 lang 属性等于 “it”（意大利）的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_last-child.asp" >:last-child<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p:last-child</td>
<td align="left">选择属于其父元素最后一个子元素每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_last-of-type.asp" >:last-of-type<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p:last-of-type</td>
<td align="left">选择属于其父元素的最后 <code>&lt;p&gt;</code> 元素的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_link.asp" >:link<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">a:link</td>
<td align="left">选择所有未访问过的链接。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_not.asp">:not(<em>selector</em>)</a></td>
<td align="left">:not(p)</td>
<td align="left">选择非 <code>&lt;p&gt;</code> 元素的每个元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_nth-child.asp">:nth-child(<em>n</em>)</a></td>
<td align="left">p:nth-child(2)</td>
<td align="left">选择属于其父元素的第二个子元素的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_nth-last-child.asp">:nth-last-child(<em>n</em>)</a></td>
<td align="left">p:nth-last-child(2)</td>
<td align="left">同上，从最后一个子元素开始计数。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_nth-of-type.asp">:nth-of-type(<em>n</em>)</a></td>
<td align="left">p:nth-of-type(2)</td>
<td align="left">选择属于其父元素第二个 <code>&lt;p&gt;</code> 元素的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_nth-last-of-type.asp">:nth-last-of-type(<em>n</em>)</a></td>
<td align="left">p:nth-last-of-type(2)</td>
<td align="left">同上，但是从最后一个子元素开始计数。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_only-of-type.asp" >:only-of-type<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p:only-of-type</td>
<td align="left">选择属于其父元素唯一的 <code>&lt;p&gt;</code> 元素的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_only-child.asp" >:only-child<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">p:only-child</td>
<td align="left">选择属于其父元素的唯一子元素的每个 <code>&lt;p&gt;</code> 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_optional.asp" >:optional<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:optional</td>
<td align="left">选择不带 “required” 属性的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_out-of-range.asp" >:out-of-range<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:out-of-range</td>
<td align="left">选择值超出指定范围的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_placeholder.asp" >::placeholder<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input::placeholder</td>
<td align="left">选择已规定 “placeholder” 属性的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_read-only.asp" >:read-only<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:read-only</td>
<td align="left">选择已规定 “readonly” 属性的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_read-write.asp" >:read-write<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:read-write</td>
<td align="left">选择未规定 “readonly” 属性的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_required.asp" >:required<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:required</td>
<td align="left">选择已规定 “required” 属性的 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_root.asp" >:root<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">:root</td>
<td align="left">选择文档的根元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_selection.asp" >::selection<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">::selection</td>
<td align="left">选择用户已选取的元素部分。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_target.asp" >:target<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">#news:target</td>
<td align="left">选择当前活动的 #news 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_valid.asp" >:valid<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">input:valid</td>
<td align="left">选择带有有效值的所有 input 元素。</td>
</tr>
<tr>
<td align="left"><a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/selector_visited.asp" >:visited<i class="fas fa-external-link-alt"></i></a></td>
<td align="left">a:visited</td>
<td align="left">选择所有已访问的链接。</td>
</tr>
</tbody></table>
<h4 id="CSS-SELECTOR"><a href="#CSS-SELECTOR" class="headerlink" title="CSS_SELECTOR"></a>CSS_SELECTOR</h4><p>HTML中经常要为某些元素指定显示效果，比如 前景文字颜色是红色， 背景颜色是黑色， 字体是微软雅黑等。</p>
<p>那么CSS必须告诉浏览器：要 <strong>选择哪些元素</strong> ， 来使用这样的显示风格。例如这个白月黑羽的<a class="link"   target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/sample1.html" >测试页<i class="fas fa-external-link-alt"></i></a><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222128816.png"
                      alt="image-20230222212838749"
                ></p>
<p>我们就可以使用<code>By.CSS_SELECTOR</code>来筛选元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample1.html&#x27;</span>)</span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;.animal&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(i.get_attribute(<span class="string">&#x27;outerHTML&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222205151.png"
                      alt="image-20230222220502070"
                ></p>
<p><code>By.CSS_SELECTOR</code>同样可以根据tag名、id 属性和 class属性 来 选择元素，</p>
<p>根据 tag名 选择元素的 CSS Selector 语法非常简单，直接写上tag名即可，</p>
<p>根据id属性 选择元素的语法是在id号前面加上一个井号： <code>#id值</code></p>
<p>根据class属性 选择元素的语法是在 class 值 前面加上一个点： <code>.class值</code></p>
<p>比如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cn.bing.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">elements = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#sb_form_q&#x27;</span>)</span><br><span class="line"><span class="comment">#通过id选择特定元素</span></span><br><span class="line">elements.send_keys(<span class="string">&#x27;Charmersix&#x27;</span>)</span><br><span class="line">search = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#search_icon&#x27;</span>)</span><br><span class="line"><span class="comment"># print(elements.get_attribute(&#x27;value&#x27;))</span></span><br><span class="line"><span class="comment"># elements.clear()</span></span><br><span class="line"><span class="comment"># elements.send_keys(&#x27;SkyMirror&#x27;)</span></span><br><span class="line">search.click()</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">clas = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;.b_attribution&#x27;</span>)</span><br><span class="line"><span class="comment">#clas = wd.find_element(By.CLASS_NAME, &#x27;.b_attribution&#x27;)</span></span><br><span class="line">cites = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;cite&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cite <span class="keyword">in</span> cites:</span><br><span class="line">    <span class="built_in">print</span>(cite.text)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302222221033.png"
                      alt="image-20230222222117959"
                ></p>
<h4 id="选择子元素和后代元素"><a href="#选择子元素和后代元素" class="headerlink" title="选择子元素和后代元素"></a>选择子元素和后代元素</h4><p>HTML中, 元素内部可以包含元素其他元素, <code>CSS_SELECTOR</code>我们可以通过使用<code>&gt;</code>来选择某个元素的子元素, 或者通过使用<code> </code>空格来选择某元素的后代元素</p>
<p>比如说</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素<span class="number">1</span>&gt;元素<span class="number">2</span>&gt;元素<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>就可以更加精准的选择到元素三</p>
<p>当然我们也可以使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素<span class="number">1</span> 元素<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>也是可以选择到元素3的</p>
<p>比如说, 这里我们想精准定位到我的这个博客地址<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231303826.png"
                      alt="image-20230223130310730"
                ></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cn.bing.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">elements = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#sb_form_q&#x27;</span>)</span><br><span class="line"><span class="comment">#通过id选择特定元素</span></span><br><span class="line">elements.send_keys(<span class="string">&#x27;Charmersix&#x27;</span>)</span><br><span class="line">search = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#search_icon&#x27;</span>)</span><br><span class="line"><span class="comment"># print(elements.get_attribute(&#x27;value&#x27;))</span></span><br><span class="line"><span class="comment"># elements.clear()</span></span><br><span class="line"><span class="comment"># elements.send_keys(&#x27;SkyMirror&#x27;)</span></span><br><span class="line">search.click()</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#clas = wd.find_element(By.CLASS_NAME, &#x27;.b_attribution&#x27;)</span></span><br><span class="line">cites = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;.b_caption&gt;.b_snippet cite&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(cites.text)</span><br><span class="line"><span class="comment"># for cite in cites:</span></span><br><span class="line"><span class="comment">#     print(cite.text)</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231308789.png"
                      alt="image-20230223130808713"
                ></p>
<h4 id="根据属性选择"><a href="#根据属性选择" class="headerlink" title="根据属性选择"></a>根据属性选择</h4><p>像我们这些id, class都是比较常见的, 所以selenium提供了固定的筛选方法, 但是网页中的属性其实是多种多样的, selenium不可能全部规定好, 所以, CSS_SELECTOR提供了可以自定义属性的方法, 就是用<code>[属性名字=属性值]</code></p>
<p>比如还是上面的例子, 我们会发现, 这个网页里的u属性是比较唯一的<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231340502.png"
                      alt="image-20230223134011448"
                ></p>
<p>但是, 我们在测试的过程中又会发现u的值会变化, 但是我们会发现一个规律, u的前几位是一样的, 这时候我们就可以使用我们的正则表达式</p>
<p>比方说<code>[u^=&quot;1|5090|&quot;]</code>表示属性值以<code>1|5090|</code>开头的, <code>[u*=&quot;1|5090|&quot;]</code>表示属性中含有<code>1|5090|</code>的, <code>[u$=&quot;1|5090|&quot;]</code>表示以<code>1|5090|</code>结尾的</p>
<p>如果一个元素具有多个属性, 我们可以直接并列这两个属性, 用来选择, 像这样<code>&#39;[u^=&quot;1|5090|&quot;][tabindex=&quot;0&quot;]&#39;</code></p>
<p>我们就可以把代码修改为这样, 达到筛选出我博客地址的效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cites = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[u^=&quot;1|5090|&quot;][tabindex=&quot;0&quot;]&gt;cite&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231346102.png"
                      alt="image-20230223134643022"
                ></p>
<h4 id="验证选择语法"><a href="#验证选择语法" class="headerlink" title="验证选择语法"></a>验证选择语法</h4><p>众所周知, python+selenium运行速度是非常慢的, 如果我们程序每次都通过debug调试的话, 效率太低. 但是我们的浏览器F12的开发者工具也是支持我们的CSS_SELECTOR语法的like this<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231402602.png"
                      alt="image-20230223140226542"
                ></p>
<p>这里我们故意写错试一下<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231403993.png"
                      alt="image-20230223140303934"
                ></p>
<p>这里就会显示0, 那么我们就很容易发现, 语法不可行</p>
<h4 id="选择语法组合使用"><a href="#选择语法组合使用" class="headerlink" title="选择语法组合使用"></a>选择语法组合使用</h4><p>上面已经提到过, 我们需要同时用多个条件限制的时候, 直接两个条件贴在一起, 像上边已经提到过的</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231428225.png"
                      alt="image-20230223142854200"
                ></p>
<p>如果我们想要同时获得两个不相干的内容, 我们可以使用<code>,</code>来隔开两个条件, 比如说, 这里我想要同时获取我的名字和我的blog地址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cites = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;[href=&quot;https://charmersix.icu/&quot;]&gt;strong,[u^=&quot;1|5&quot;][tabindex=&quot;0&quot;]&gt;cite&#x27;</span>)</span><br><span class="line"><span class="comment"># print(cites.text)</span></span><br><span class="line"><span class="keyword">for</span> cite <span class="keyword">in</span> cites:</span><br><span class="line">    <span class="built_in">print</span>(cite.text)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302231816084.png"
                      alt="image-20230223181625001"
                ></p>
<h4 id="父元素的第n个子节点"><a href="#父元素的第n个子节点" class="headerlink" title="父元素的第n个子节点"></a>父元素的第n个子节点</h4><p>我们可以指定选择的元素是父元素的第几个子节点</p>
<p>使用<code>nth-child</code></p>
<p>比如说, 如果我们选择的是第二个子元素, 并且是<code>span</code>类型, 所以我们可以这样写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">span:nth-child(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>如果选择的是所有位置为第二个的所有元素, 不管是什么类型, 可以直接写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:nth-child(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>这里我们也可以指定父元素, 比如说我们可以通过父元素的id来指定, 这里借用一下<a class="link"   target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/sample1b.html" >白月黑羽测试页<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#t1&gt;:nth-child(2)</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302232213828.png"
                      alt="image-20230223221304758"
                ></p>
<p>当然也可以通过倒数来选择, 通过<code>nth-last-child</code></p>
<p>像这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p:nth-last-child(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302232218815.png"
                      alt="image-20230223221836749"
                ></p>
<h4 id="父元素的第几个某类型的子节点"><a href="#父元素的第几个某类型的子节点" class="headerlink" title="父元素的第几个某类型的子节点"></a>父元素的第几个某类型的子节点</h4><p>这里我们使用<code>:nth-of-type()</code></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302232311436.png"
                      alt="image-20230223231118354"
                ></p>
<p>同样, 倒数的是<code>:nth-last-of-type()</code></p>
<h4 id="奇数节点和偶数节点"><a href="#奇数节点和偶数节点" class="headerlink" title="奇数节点和偶数节点"></a>奇数节点和偶数节点</h4><p>果要选择的是父元素的 <code>偶数节点</code>，使用 <code>nth-child(even)</code></p>
<p>比如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p:nth-child(even)</span><br></pre></td></tr></table></figure>

<p>如果要选择的是父元素的 <code>奇数节点</code>，使用 <code>nth-child(odd)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p:nth-child(odd)</span><br></pre></td></tr></table></figure>

<p>如果要选择的是父元素的 <code>某类型偶数节点</code>，使用 <code>:nth-of-type(even)</code></p>
<p>如果要选择的是父元素的 <code>某类型奇数节点</code>，使用 <code>:nth-of-type(odd)</code></p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302232314760.png"
                      alt="image-20230223231439690"
                ></p>
<h4 id="兄弟节点选择"><a href="#兄弟节点选择" class="headerlink" title="兄弟节点选择"></a>兄弟节点选择</h4><p>相邻的兄弟关系我们可以用<code>+</code>来表示</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302240904835.png"
                      alt="image-20230224090359706"
                ></p>
<p>如果不相邻, 但是是后面的兄弟节点, 可以用<code>~</code>表示</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302240904613.png"
                      alt="image-20230224090435546"
                ></p>
<h3 id="frame切换"><a href="#frame切换" class="headerlink" title="frame切换"></a>frame切换</h3><p> 这里我们再次借用一下白月黑羽的<a class="link"   target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/sample2.html" >测试页<i class="fas fa-external-link-alt"></i></a>, 比如说, 在这个界面里我们想要获取这些蔬菜的名字, 我们像往常一样, 写下这一串代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;</span>)</span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;.plant&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302242149051.png"
                      alt="image-20230224214901932"
                ></p>
<p>仔细看, 我们会发现这些元素都是在一个叫<code>iframe</code>的元素中, 这个<code>iframe</code>中又嵌套了一个HTML, 在HTML语法中, <code>frame</code>元素或者<code>iframe</code>元素的内部会包含一个被嵌入的一个HTML</p>
<p>如果我们直接<code>find_elements</code>的话, 是在我们第一层的里寻找, 很明显是无法找到的, 就算找到了也不是我们想要的内容</p>
<p>如果我们要操作被嵌入的HTML中的元素, 就必须切换一下操作范围, 使用<code>wd.switch_to.frame(frame_reference)</code></p>
<p>其中<code>frame_reference</code>可以是<code>frame</code>元素的属性<code>name</code>或者<code>ID</code></p>
<p>比如这里, 可以直接写成<code>wd.switch_to.frame(&#39;frame1&#39;)</code>或者<code>wd.switch_to.frame(&#39;innerFrame&#39;)</code></p>
<p>我们也可以填写frame所对应的webelement对象, 就是在<code>.switch_to.frame()</code>的括号里再套用<code>find_element</code>系列的方法, 比如这里也可以写成<code>wd.switch_to.frame(wd.find_element(By.TAG_NAME, &quot;iframe&quot;))</code></p>
<p>所以我们正确的代码应该是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;</span>)</span><br><span class="line"><span class="comment">#wd.switch_to.frame(&#x27;frame1&#x27;)</span></span><br><span class="line"><span class="comment">#wd.switch_to.frame(&#x27;innerFrame&#x27;)</span></span><br><span class="line">wd.switch_to.frame(wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;iframe&#x27;</span>))</span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR,<span class="string">&#x27;.plant&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302242325240.png"
                      alt="image-20230224232524099"
                ></p>
<p>那么, 这时候, 如果我们想再出来操作外层的HTML元素怎么办呢, 例如这里我们想点击一下这个外层的按钮<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302242327360.png"
                      alt="image-20230224232731303"
                ></p>
<p>我们只需要执行<code>wd.switch_to.default_content()</code></p>
<p>像这样, 只要返回了<code>你点击了外部按钮</code>, 就说明我们代码执行成功</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/sample2.html&#x27;</span>)</span><br><span class="line"><span class="comment">#wd.switch_to.frame(&#x27;frame1&#x27;)</span></span><br><span class="line"><span class="comment">#wd.switch_to.frame(&#x27;innerFrame&#x27;)</span></span><br><span class="line">wd.switch_to.frame(wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;iframe&#x27;</span>))</span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR,<span class="string">&#x27;.plant&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(i.text)</span><br><span class="line">wd.switch_to.default_content()</span><br><span class="line">wd.find_element(By.ID,<span class="string">&#x27;outerbutton&#x27;</span>).click()</span><br><span class="line">respon = wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;#add&gt;li&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(respon.text)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302242334908.png"
                      alt="image-20230224233430830"
                ></p>
<h3 id="窗口切换"><a href="#窗口切换" class="headerlink" title="窗口切换"></a>窗口切换</h3><p>有时候我们会遇到, 需要点击超链接进入到下一个窗口的情况, 比方说这里, 我想通过bing找到我的B站后, 进入到我的B站里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span>  By</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment">#from selenium.webdriver.chrome.service import Service</span></span><br><span class="line">wd = webdriver.Chrome()<span class="comment">#service = Service(r&#x27;G:\tools\chromedriver\chromedriver.exe&#x27;))</span></span><br><span class="line"><span class="comment"># 创建 WebDriver 对象，指明使用chrome浏览器驱动</span></span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://cn.bing.com/&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用WebDriver 对象的get方法 可以让浏览器打开指定网址</span></span><br><span class="line">elements = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#sb_form_q&#x27;</span>)</span><br><span class="line"><span class="comment">#通过id选择特定元素</span></span><br><span class="line">elements.send_keys(<span class="string">&#x27;Charmersix&#x27;</span>)</span><br><span class="line">search = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#search_icon&#x27;</span>)</span><br><span class="line"><span class="comment"># print(elements.get_attribute(&#x27;value&#x27;))</span></span><br><span class="line"><span class="comment"># elements.clear()</span></span><br><span class="line"><span class="comment"># elements.send_keys(&#x27;SkyMirror&#x27;)</span></span><br><span class="line">search.click()</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;[data-bm=&quot;6&quot;]&gt;div&gt;h2&gt;a&#x27;</span>).click()</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">for</span> handle <span class="keyword">in</span> wd.window_handles:</span><br><span class="line">    wd.switch_to.window(handle)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Charmersix&#x27;</span> <span class="keyword">in</span> wd.title:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(wd.title)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302251319764.png"
                      alt="image-20230225131900679"
                ></p>
<p>如果我们想再次回到原来的界面, 可以事先保存老窗口, 像这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">main = wd.current_window_handle</span><br><span class="line">wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;[data-bm=&quot;6&quot;]&gt;div&gt;h2&gt;a&#x27;</span>).click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> handle <span class="keyword">in</span> wd.window_handles:</span><br><span class="line">    wd.switch_to.window(handle)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Charmersix_小六的个人空间_哔哩哔哩_bilibili&#x27;</span> <span class="keyword">in</span> wd.title:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">wd.switch_to.window(main)</span><br><span class="line"><span class="built_in">print</span>(wd.title)</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302251318399.png"
                      alt="image-20230225131821274"
                ></p>
<h3 id="选择框"><a href="#选择框" class="headerlink" title="选择框"></a>选择框</h3><p>这里借用白月黑羽师傅的<a class="link"   target="_blank" rel="noopener" href="https://cdn2.byhy.net/files/selenium/test2.html" >测试页<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="radio"><a href="#radio" class="headerlink" title="radio"></a>radio</h4><p>直接使用<code>click</code>方法点击选择即可, 首先, 我们可以用<code>:checked</code>来判断出已经选择的元素, 然后我们再点击重新选择一个新的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;</span>)</span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;#s_radio input:checked&#x27;</span>)</span><br><span class="line"><span class="comment">#:checked是CSS伪类选择,对radio和checkbox类型的input都有效</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前选择的是&quot;</span>+element.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;#s_radio input[value=&quot;小雷老师&quot;]&#x27;</span>).click()</span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;#s_radio input:checked&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前选择的已经改为&quot;</span>+element.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302251434224.png"
                      alt="image-20230225143417138"
                ></p>
<h4 id="checkbox"><a href="#checkbox" class="headerlink" title="checkbox"></a>checkbox</h4><p>checkbox是复选框, 这里如果已经选择的框, 再去点击就会取消选择, 所以我们在选择开始前, 我们就先筛选出已经选择框点一下取消掉, 然后再去选择我们想选的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;</span>)</span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR,<span class="string">&#x27;#s_checkbox input:checked&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;当前选择的为&quot;</span>+element.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br><span class="line">    element.click()</span><br><span class="line"></span><br><span class="line">obj = wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;#s_checkbox input[value=&quot;小雷老师&quot;]&#x27;</span>).click()</span><br><span class="line">obj = wd.find_element(By.CSS_SELECTOR,<span class="string">&#x27;#s_checkbox input[value=&quot;小江老师&quot;]&#x27;</span>).click()</span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR,<span class="string">&#x27;#s_checkbox input:checked&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;当前选择的已经改为&quot;</span>+element.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302251453678.png"
                      alt="image-20230225145318585"
                >    </p>
<h4 id="select"><a href="#select" class="headerlink" title="select"></a>select</h4><p>radio和checkbox都是input元素, 只是里边的type不同而已</p>
<p>select则是一个新的select标签, 对于select, selenium提供了专门的Select类进行操作</p>
<p>Select类中 提供了以下的方法</p>
<ul>
<li>select_by_value 根据选项的value属性值选择元素</li>
<li>select_by_index 根据选项的次序(从1开始)选择元素</li>
<li>select_by_visible_text 根据选项的可见文本选择元素</li>
<li>deselect_by_ 是去除选中元素, 同样适用上述方法</li>
<li>deselect_all 去除选中的所有元素</li>
</ul>
<h5 id="单选框"><a href="#单选框" class="headerlink" title="单选框"></a>单选框</h5><p>对于单选框, 比较简单, 无论之前选的什么, 只需要直接选择即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;</span>)</span><br><span class="line">obj = Select(wd.find_element(By.ID, <span class="string">&#x27;ss_single&#x27;</span>))</span><br><span class="line"></span><br><span class="line">obj.select_by_visible_text(<span class="string">&#x27;小江老师&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;当前选择的为&quot;</span>+obj.get_attribute(<span class="string">&#x27;value&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302251557337.png"
                      alt="image-20230225155731252"
                ></p>
<h5 id="多选框"><a href="#多选框" class="headerlink" title="多选框"></a>多选框</h5><p>同上, 先用<code>deselect_all()</code>清除所有, 然后再选择</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.get(<span class="string">&#x27;https://cdn2.byhy.net/files/selenium/test2.html&#x27;</span>)</span><br><span class="line">obj = Select(wd.find_element(By.ID, <span class="string">&#x27;ss_multi&#x27;</span>))</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">obj.deselect_all()</span><br><span class="line">obj.select_by_value(<span class="string">&#x27;小江老师&#x27;</span>)</span><br><span class="line">obj.select_by_value(<span class="string">&#x27;小雷老师&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>()</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302251602564.png"
                      alt="image-20230225160225478"
                ></p>
<h3 id="实战技巧"><a href="#实战技巧" class="headerlink" title="实战技巧"></a>实战技巧</h3><h4 id="其他操作方法"><a href="#其他操作方法" class="headerlink" title="其他操作方法"></a>其他操作方法</h4><p>之前我们对web元素做的主要操作是：选择元素,然后点击元素或者输入字符串, 其他操作我们可以通过Selenium提供的ActionChains类来实现</p>
<p>ActionChains类里面提供了一些特殊的动作的模拟, 我们可以通过查看ActionChains类的代码看到如下方法<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302281806746.png"
                      alt="image-20230228180643656"
                ></p>
<p>这里我们举一个鼠标移动的例子, 比如说, 我们的百度页面上, 有这个<code>更多</code>框, 这个框里的内容只有将鼠标移上才能显示出来<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302281845474.png"
                      alt="image-20230228184558362"
                ></p>
<p>代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">wd.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ac = ActionChains(wd)</span><br><span class="line">ac.move_to_element(wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[name=&quot;tj_briicon&quot;]&#x27;</span>)).perform()</span><br><span class="line"><span class="comment">#perform()必须要有, 是执行的意思, 否则操作不会执行</span></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202302281859491.png"
                      alt="image-20230228185942408"
                ></p>
<h4 id="执行JavaScript"><a href="#执行JavaScript" class="headerlink" title="执行JavaScript"></a>执行JavaScript</h4><p>我们可以调用<code>execute_script</code>执行我们的JavaScript代码</p>
<p>例如, 有时我们访问的网页很长, 我们要点击的元素没有在窗口可以显示的范围内, selenium就会报类似这种错误</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">element click intercepted: Element &lt;span&gt;这里是元素html&lt;/span&gt; </span><br><span class="line"><span class="keyword">is</span> <span class="keyword">not</span> clickable at point (<span class="number">119</span>, <span class="number">10</span>). </span><br><span class="line">Other element would receive the click: &lt;div&gt;...&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>这时候, 我们就可以用下面这串代码, 让需要点击的元素出现在页面的最中间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.execute_script(<span class="string">&quot;arguments[0].scrollIntoView(&#123;block:&#x27;center&#x27;,inline:&#x27;center&#x27;&#125;)&quot;</span>, job)</span><br></pre></td></tr></table></figure>

<p>其中<code>arguments[0]</code>指代了后面的第一个参数<code>job</code>对应的js对象, js对象的<code>scrollIntoView</code>方法就是让元素滚动到可见部分</p>
<p><code>block:&#39;center&#39;</code> 指定垂直方向居中</p>
<p><code>inline:&#39;center&#39;</code> 指定水平方向居中</p>
<p>我们也可以通过下面这串代码, 来判断我们一个网站到底有几页</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">nextPageButtonDisabled = driver.execute_script(</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ele = document.querySelector(&#x27;.soupager &gt; button:last-of-type&#x27;);</span></span><br><span class="line"><span class="string">    return ele.getAttribute(&#x27;disabled&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回的数据转化为Python中的数据对象进行后续处理</span></span><br><span class="line"><span class="keyword">if</span> nextPageButtonDisabled == <span class="string">&#x27;disabled&#x27;</span>: <span class="comment"># 是最后一页</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="keyword">else</span>: <span class="comment"># 不是最后一页</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这段代码是使用 Selenium WebDriver 和 JavaScript 执行一个查询，检查是否存在下一页的按钮，并返回该按钮是否被禁用(disabled)的状态。</p>
<p>具体来说，这段代码做了以下几件事情：</p>
<ol>
<li>使用 <code>driver.execute_script()</code> 方法来执行一个 JavaScript 代码块。</li>
<li>JavaScript 代码块中，使用 <code>document.querySelector()</code> 方法选择了 HTML 文档中的一个 class 为 <code>soupager</code> 的元素，并选中了该元素下面的最后一个 button 元素。</li>
<li>接着使用 <code>ele.getAttribute(&#39;disabled&#39;)</code> 方法获取该 button 元素的 <code>disabled</code> 属性值，并将其返回给 Python 变量 <code>nextPageButtonDisabled</code>。</li>
<li>最后根据 <code>nextPageButtonDisabled</code> 的值是否为字符串 ‘disabled’，来判断下一页的按钮是否被禁用(disabled)。</li>
</ol>
<p>如果 <code>nextPageButtonDisabled</code> 的值为 ‘disabled’，则表示下一页的按钮已被禁用，Python 函数将返回 True；否则，Python 函数将返回 False。</p>
</blockquote>
<h4 id="冻结界面"><a href="#冻结界面" class="headerlink" title="冻结界面"></a>冻结界面</h4><p>像上面例子一样, 当我们光标移开的时候, <code>更多</code>里面的内容就无了, 这时候我们如果想要进一步操<code>更多</code>里面的内容, 我们就需要将眼前的界面冻结, 才能继续操作</p>
<p>这里我们就需要利用JavaScript代码的<code>debugger</code>功能, 冻结页面</p>
<p>可以让浏览器执行下列js代码, 进入debug状态, 冻住界面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">debugger</span>&#125;, <span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<p>这串代码意思是, 在5000ms也就是5s后, 执行页面的debugger命令, 冻住界面, 由于我们还需要进行鼠标移动的操作, 所以说要在5s后冻住界面</p>
<p>这样就方便我们寻找元素</p>
<h4 id="弹出对话框"><a href="#弹出对话框" class="headerlink" title="弹出对话框"></a>弹出对话框</h4><h5 id="Alert"><a href="#Alert" class="headerlink" title="Alert"></a>Alert</h5><p>alert弹出框, selenium提供了点击方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.driver.switch_to.alert.accept()</span><br></pre></td></tr></table></figure>

<p>如果是获取对话框中的文本, 可以通过如下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.alert.text</span><br></pre></td></tr></table></figure>

<h5 id="Confirm"><a href="#Confirm" class="headerlink" title="Confirm"></a>Confirm</h5><p>相比于alert, 多了一个取消按钮, 可以用dismiss, 代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.alert.dismiss()</span><br></pre></td></tr></table></figure>

<h5 id="Prompt"><a href="#Prompt" class="headerlink" title="Prompt"></a>Prompt</h5><p>相比于上面两个, 多了一个填信息的框, 方法如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.switch_to.alert.send_keys()</span><br></pre></td></tr></table></figure>

<p>我们可以通过下面的代码感受一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome()</span><br><span class="line">wd.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;https://www.baidu.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">wd.execute_script(<span class="string">&quot;alert(&#x27;charmersixalert&#x27;)&quot;</span>)</span><br><span class="line"></span><br><span class="line">alert = wd.switch_to.alert</span><br><span class="line"><span class="built_in">print</span>(alert.text)</span><br><span class="line">alert.accept()</span><br><span class="line">prompt = wd.execute_script(<span class="string">&quot;confirm(&#x27;charmersixconfirm&#x27;)&quot;</span>)</span><br><span class="line"></span><br><span class="line">confirm = wd.switch_to.alert</span><br><span class="line"><span class="built_in">print</span>(confirm.text)</span><br><span class="line">confirm.dismiss()</span><br><span class="line"></span><br><span class="line">wd.execute_script(<span class="string">&quot;prompt(&#x27;charmersixprompt&#x27;)&quot;</span>)</span><br><span class="line"></span><br><span class="line">prompt = wd.switch_to.alert</span><br><span class="line"><span class="built_in">print</span>(prompt.text)</span><br><span class="line">prompt.send_keys(<span class="string">&quot;666&quot;</span>)</span><br><span class="line">prompt.accept()</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202303012220148.png"
                      alt="image-20230301222006864"
                ></p>
<h4 id="窗口"><a href="#窗口" class="headerlink" title="窗口"></a>窗口</h4><h5 id="获取窗口大小"><a href="#获取窗口大小" class="headerlink" title="获取窗口大小"></a>获取窗口大小</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.get_window_size()</span><br></pre></td></tr></table></figure>



<h5 id="改变窗口大小"><a href="#改变窗口大小" class="headerlink" title="改变窗口大小"></a>改变窗口大小</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.set_window_size(x, y)</span><br></pre></td></tr></table></figure>

<h5 id="获取当前窗口标题"><a href="#获取当前窗口标题" class="headerlink" title="获取当前窗口标题"></a>获取当前窗口标题</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.title</span><br></pre></td></tr></table></figure>

<h5 id="获取当前窗口的url地址"><a href="#获取当前窗口的url地址" class="headerlink" title="获取当前窗口的url地址"></a>获取当前窗口的url地址</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.current_url</span><br></pre></td></tr></table></figure>

<h5 id="截屏"><a href="#截屏" class="headerlink" title="截屏"></a>截屏</h5><p>在做自动化测试的时候, 我们有时候需要截屏方便人工核查或者方便debug, 这时候我们可以用<code>get_screenshot_as_file</code>方法来截屏并保存</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wd.get_screenshot_as_file(<span class="string">&#x27;./1.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="手机模式"><a href="#手机模式" class="headerlink" title="手机模式"></a>手机模式</h5><p>可以通过<code>desired_capabilities</code>参数, 指定以手机模式打开chrome浏览器</p>
<p>这里我们统一实验一下上述代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">mobile_emulation = &#123;<span class="string">&quot;driverName&quot;</span>: <span class="string">&quot;iphone6s&quot;</span>&#125;</span><br><span class="line">cheome_option = webdriver.ChromeOptions()</span><br><span class="line">cheome_option.add_experimental_option(<span class="string">&quot;mobileEmulation&quot;</span>, mobile_emulation)</span><br><span class="line">wd = webdriver.Chrome(desired_capabilities = cheome_option.to_capabilities())</span><br><span class="line"></span><br><span class="line">wd.get(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line">size = wd.get_window_size()</span><br><span class="line">title = wd.title</span><br><span class="line">url = wd.current_url</span><br><span class="line">wd.get_screenshot_as_file(<span class="string">&#x27;./1.png&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(size, title, url)</span><br><span class="line">wd.quit()</span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202303022009733.png"
                      alt="image-20230302200927480"
                ></p>
<h4 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h4><p>通常, 网站页面上传文件的功能, 是通过<code>type</code>属性为<code>file</code>的HTML <code>input</code>元素实现的, 我们想要自动化上传文件, 只需要定位到input元素, 然后通过<code>send_keys</code>方法传入要上传的文件路径即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ele = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;input[type=file]&#x27;</span>)</span><br><span class="line"><span class="comment"># 先定位到上传文件的 input 元素</span></span><br><span class="line">ele.send_keys(<span class="string">r&#x27;h:\1.png&#x27;</span>)</span><br><span class="line"><span class="comment"># 调用send_keys方法</span></span><br></pre></td></tr></table></figure>

<p>如果需要多次上传, 则多次调用即可, 但是，有的网页上传，是没有 file 类型 的 input 元素的。就需要再自己分析</p>
<p>如果是Windows上的自动化，可以采用 Windows 平台专用的方法：</p>
<p>确保 pywin32 已经安装，然后参考如下示例代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 找到点击上传的元素，点击</span></span><br><span class="line">driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;.dropzone&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) <span class="comment"># 等待上传选择文件对话框打开</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接发送键盘消息给 当前应用程序，</span></span><br><span class="line"><span class="comment"># 前提是浏览器必须是当前应用</span></span><br><span class="line"><span class="keyword">import</span> win32com.client</span><br><span class="line">shell = win32com.client.Dispatch(<span class="string">&quot;WScript.Shell&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入文件路径，最后的&#x27;\n&#x27;，表示回车确定，也可能时 &#x27;\r&#x27; 或者 &#x27;\r\n&#x27;</span></span><br><span class="line">shell.Sendkeys(<span class="string">r&quot;h:\a2.png&quot;</span> + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这段代码是使用Python中的Selenium库，模拟用户上传文件的操作。下面是逐行解释：</p>
<ol>
<li><code>driver.find_element(By.CSS_SELECTOR, &#39;.dropzone&#39;).click()</code>: 这行代码使用Selenium库的<code>find_element</code>方法根据CSS选择器定位页面上class为<code>dropzone</code>的元素，然后使用<code>click</code>方法模拟用户点击该元素，以此触发文件上传的功能。</li>
<li><code>sleep(2)</code>: 这行代码使用Python标准库的<code>time</code>模块中的<code>sleep</code>函数，让程序等待2秒钟，等待上传选择文件对话框打开。</li>
<li><code>import win32com.client</code>: 这行代码导入<code>win32com</code>模块的<code>client</code>子模块，用于调用Windows系统的COM接口。</li>
<li><code>shell = win32com.client.Dispatch(&quot;WScript.Shell&quot;)</code>: 这行代码使用<code>win32com</code>模块的<code>Dispatch</code>函数创建一个名为<code>shell</code>的COM对象，该对象表示Windows系统中的Shell应用程序。</li>
<li><code>shell.Sendkeys(r&quot;h:\a2.png&quot; + &#39;\n&#39;)</code>: 这行代码使用<code>shell</code>对象的<code>Sendkeys</code>方法，向当前应用程序发送一个包含文件路径和回车键的键盘消息。其中<code>r&quot;h:\a2.png&quot;</code>是要上传的文件路径，<code>&#39;\n&#39;</code>表示回车键。由于该函数的实现需要通过Windows的COM接口与应用程序交互，因此该函数的执行结果实际上是模拟用户在应用程序中按下了对应的按键。</li>
<li><code>sleep(1)</code>: 这行代码使用<code>time</code>模块的<code>sleep</code>函数，让程序等待1秒钟，确保文件上传完成。</li>
</ol>
</blockquote>
<h3 id="Xpath选择器"><a href="#Xpath选择器" class="headerlink" title="Xpath选择器"></a>Xpath选择器</h3><p>有些场景用css选择web元素很麻烦, 然而<code>xpath</code>比较方便</p>
<h4 id="绝对路径选择"><a href="#绝对路径选择" class="headerlink" title="绝对路径选择"></a>绝对路径选择</h4><p>相当于css选择器的<code>&gt;</code></p>
<p>例如, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.XPATH, <span class="string">&quot;/html/body/div&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>就相当于</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.CSS_SELECTOR, <span class="string">&quot;html&gt;body&gt;div&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="相对路径选择"><a href="#相对路径选择" class="headerlink" title="相对路径选择"></a>相对路径选择</h4><p>相当于css选择器中的<code> </code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.XPATH, <span class="string">&quot;//div//p&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>相当于</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.CSS_SELECTOR,<span class="string">&quot;div p&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h4><p>如果要选择所有div节点的所有直接子节点，可以使用表达式 <code>//div/*</code></p>
<p><code>*</code> 是一个通配符，对应任意节点名的元素，等价于CSS选择器 <code>div &gt; *</code></p>
<h4 id="根据属性选择-1"><a href="#根据属性选择-1" class="headerlink" title="根据属性选择"></a>根据属性选择</h4><p>Xpath可以根据属性来选择元素, 大致格式是<code>[@属性名=&#39;属性值&#39;]</code></p>
<p>这里属性值可以为空</p>
<p>注意:</p>
<ul>
<li>属性名前面要有@</li>
<li>属性值要有引号, 单双无所谓</li>
</ul>
<p>但是xpath与css不同的是, xpath选择时, 必须要有标签名, 但是标签名可以用<code>*</code>通配</p>
<p>例如<img  
                     lazyload
                     alt="image"
                     data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202303052225942.png"
                      alt="image-20230305222515640"
                ></p>
<h4 id="属性值包含字符串"><a href="#属性值包含字符串" class="headerlink" title="属性值包含字符串"></a>属性值包含字符串</h4><p>要选择 style属性值 包含 color 字符串的 页面元素 ，可以这样 <code>//*[contains(@style,&#39;color&#39;)]</code></p>
<p>要选择 style属性值 以 color 字符串 <code>开头</code> 的 页面元素 ，可以这样 <code>//*[starts-with(@style,&#39;color&#39;)]</code></p>
<p>要选择 style属性值 以 某个 字符串 结尾 的 页面元素 ，大家可以推测是 <code>//*[ends-with(@style,&#39;color&#39;)]</code>， 但是，很遗憾，这是xpath 2.0 的语法 ，目前浏览器都不支持</p>
<h4 id="按次序选择"><a href="#按次序选择" class="headerlink" title="按次序选择"></a>按次序选择</h4><p>xpath可以直接在<code>[]</code>中使用数字表示次序</p>
<h5 id="某类型的第几个元素"><a href="#某类型的第几个元素" class="headerlink" title="某类型的第几个元素"></a>某类型的第几个元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//p[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p>选择的是p类型的第二个子元素, 相当于css选择器的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:nth-of-<span class="built_in">type</span>()</span><br></pre></td></tr></table></figure>

<p>第几个子元素的话, 可以用通配符<code>*</code>来代替类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h5 id="某类型的倒数第几个子元素"><a href="#某类型的倒数第几个子元素" class="headerlink" title="某类型的倒数第几个子元素"></a>某类型的倒数第几个子元素</h5><p>使用<code>last()-数字</code></p>
<ul>
<li><p>倒数第一个</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//p[last()]</span><br></pre></td></tr></table></figure></li>
<li><p>倒数第二个</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//p[last()-<span class="number">1</span>]</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="范围选择"><a href="#范围选择" class="headerlink" title="范围选择"></a>范围选择</h5><p>使用<code>position()</code></p>
<ul>
<li>比如说<code>option</code>类型的前两个元素</li>
</ul>
<p>可以是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//option[position()&lt;=<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//option[position()&lt;<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>选择class属性为multi_choice的前3个子元素</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;multi_choice&#x27;</span>]/*[position()&lt;=<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>选择class属性为multi_choice的后3个子元素</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;multi_choice&#x27;</span>]/*[position()&gt;=last()-<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h4 id="组选择和兄弟节点"><a href="#组选择和兄弟节点" class="headerlink" title="组选择和兄弟节点"></a>组选择和兄弟节点</h4><h5 id="组选择"><a href="#组选择" class="headerlink" title="组选择"></a>组选择</h5><p>css有组选择, 可以同时多个表达式, 多个表达式选择的结果都是要选择的元素</p>
<p>css组选择, 表达式之间用<code>,</code>隔开</p>
<p>xpath组选择, 表达式用<code>|</code>隔开</p>
<p>比如，要选所有的option元素 和所有的 h4 元素，可以使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//option | //h4</span><br></pre></td></tr></table></figure>

<p>等同于css选择器的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">option , h4</span><br></pre></td></tr></table></figure>

<p>再比如，要选所有的 class 为 single_choice 和 class 为 multi_choice 的元素，可以使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;single_choice&#x27;</span>] | //*[@<span class="keyword">class</span>=<span class="string">&#x27;multi_choice&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>等同于css选择器</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.single_choice</span> , <span class="selector-class">.multi_choice</span></span><br></pre></td></tr></table></figure>

<h5 id="选择父节点"><a href="#选择父节点" class="headerlink" title="选择父节点"></a>选择父节点</h5><p>xpath可以选择父节点, 而css没有这一功能, 父节点用<code>/..</code>表示</p>
<p>比如，要选择 id 为 china 的节点的父节点，可以这样写 <code>//*[@id=&#39;china&#39;]/..</code> </p>
<p>当某个元素没有特征可以直接选择，但是它有子节点有特征， 就可以采用这种方法，先选择子节点，再指定父节点。</p>
<h5 id="兄弟节点选择-1"><a href="#兄弟节点选择-1" class="headerlink" title="兄弟节点选择"></a>兄弟节点选择</h5><p>类似于前面css选择器的<code>~</code></p>
<p>这里xpath用<code>following-sibling::</code></p>
<p>比如，要选择 class 为 single_choice 的元素的所有后续兄弟节点 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;single_choice&#x27;</span>]/following-sibling::*</span><br></pre></td></tr></table></figure>

<p>等同于CSS选择器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.single_choice ~ *</span><br></pre></td></tr></table></figure>

<p>如果，要选择后续节点中的div节点， 就应该这样写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;single_choice&#x27;</span>]/following-sibling::div</span><br></pre></td></tr></table></figure>

<p>xpath还可以选择前面的兄弟节点, 使用<code>preceding-sibling::</code></p>
<p>比如，要选择 class 为 single_choice 的元素的所有前面的兄弟节点 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//*[@<span class="keyword">class</span>=<span class="string">&#x27;single_choice&#x27;</span>]/preceding-sibling::*</span><br></pre></td></tr></table></figure>

<p>而CSS选择器目前还没有方法选择前面的 兄弟节点</p>
<p>想了解更多可以关注一下<a class="link"   target="_blank" rel="noopener" href="https://www.w3school.com.cn/xpath/index.asp" >xapth手册<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="selenium-注意点"><a href="#selenium-注意点" class="headerlink" title="selenium 注意点"></a>selenium 注意点</h4><p>我们来看一个例子</p>
<p>我们的代码：</p>
<ul>
<li>先选择示例网页中，id是china的元素</li>
<li>然后通过这个元素的WebElement对象，使用find_elements_by_xpath，选择里面的p元素，</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先寻找id是china的元素</span></span><br><span class="line">china = wd.find_element(By.ID, <span class="string">&#x27;china&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 再选择该元素内部的p元素</span></span><br><span class="line">elements = china.find_elements(By.XPATH, <span class="string">&#x27;//p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印结果</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;----------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(element.get_attribute(<span class="string">&#x27;outerHTML&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>运行发现，打印的 不仅仅是 china内部的p元素， 而是所有的p元素。</p>
<p>要在某个元素内部使用xpath选择元素， 需要 <code>在xpath表达式最前面加个点</code> 。</p>
<p>像这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = china.find_elements(By.XPATH, <span class="string">&#x27;.//p&#x27;</span>)</span><br></pre></td></tr></table></figure>

            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/python/">#python</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/Study/">#Study</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/Selenium/">#Selenium</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2023/03/24/web_9_PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">Web_9_PHP代码审计</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/02/28/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">西湖论剑MISC</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;Comments
    </div>
    
        
            

    <div class="waline-comment-container">
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"/>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline-meta.css"/>
        <script data-pjax src="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.js"></script>
        <div id="waline-comment"></div>
        <script data-pjax>
          function loadWaline() {
            Waline.init({
              el: '#waline-comment',
              serverURL: 'https://lsvf4zhg.api.lncldglobal.com',
              lang: 'en' || 'zh-CN',
              comment: '.post-comments-count',
              reaction: 'true' === 'true'
            })
          }

          if ('true' === 'true') {
            setTimeout(() => {
              loadWaline()
            }, 1000)
          } else {
            window.addEventListener('DOMContentLoaded', loadWaline)
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#selenium%E5%8E%9F%E7%90%86"><span class="nav-text">selenium原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="nav-text">环境配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B"><span class="nav-text">简单实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E6%B3%95"><span class="nav-text">选择元素的基本方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%89%E5%BE%85%E5%85%83%E7%B4%A0%E5%87%BA%E7%8E%B0"><span class="nav-text">等待元素出现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E6%8E%A7%E5%85%83%E7%B4%A0"><span class="nav-text">操控元素</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%82%B9%E5%87%BB%E5%85%83%E7%B4%A0"><span class="nav-text">点击元素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E6%A1%86"><span class="nav-text">输入框</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E4%BF%A1%E6%81%AF"><span class="nav-text">获取元素信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E5%B1%9E%E6%80%A7"><span class="nav-text">获取元素属性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B4%E4%B8%AA%E5%85%83%E7%B4%A0%E5%AF%B9%E5%BA%94%E7%9A%84HTML"><span class="nav-text">获取整个元素对应的HTML</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%BE%93%E5%85%A5%E6%A1%86%E9%87%8C%E7%9A%84%E6%96%87%E5%AD%97"><span class="nav-text">获取输入框里的文字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E6%96%87%E6%9C%AC%E5%86%85%E5%AE%B9"><span class="nav-text">获取元素文本内容</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#css%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">css表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSS-%E9%80%89%E6%8B%A9%E5%99%A8"><span class="nav-text">CSS 选择器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CSS-SELECTOR"><span class="nav-text">CSS_SELECTOR</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E5%AD%90%E5%85%83%E7%B4%A0%E5%92%8C%E5%90%8E%E4%BB%A3%E5%85%83%E7%B4%A0"><span class="nav-text">选择子元素和后代元素</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9"><span class="nav-text">根据属性选择</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E9%80%89%E6%8B%A9%E8%AF%AD%E6%B3%95"><span class="nav-text">验证选择语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E8%AF%AD%E6%B3%95%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8"><span class="nav-text">选择语法组合使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%88%B6%E5%85%83%E7%B4%A0%E7%9A%84%E7%AC%ACn%E4%B8%AA%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-text">父元素的第n个子节点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%88%B6%E5%85%83%E7%B4%A0%E7%9A%84%E7%AC%AC%E5%87%A0%E4%B8%AA%E6%9F%90%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-text">父元素的第几个某类型的子节点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A5%87%E6%95%B0%E8%8A%82%E7%82%B9%E5%92%8C%E5%81%B6%E6%95%B0%E8%8A%82%E7%82%B9"><span class="nav-text">奇数节点和偶数节点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9"><span class="nav-text">兄弟节点选择</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#frame%E5%88%87%E6%8D%A2"><span class="nav-text">frame切换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AA%97%E5%8F%A3%E5%88%87%E6%8D%A2"><span class="nav-text">窗口切换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E6%A1%86"><span class="nav-text">选择框</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#radio"><span class="nav-text">radio</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#checkbox"><span class="nav-text">checkbox</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#select"><span class="nav-text">select</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8D%95%E9%80%89%E6%A1%86"><span class="nav-text">单选框</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E9%80%89%E6%A1%86"><span class="nav-text">多选框</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7"><span class="nav-text">实战技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95"><span class="nav-text">其他操作方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%A7%E8%A1%8CJavaScript"><span class="nav-text">执行JavaScript</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%BB%E7%BB%93%E7%95%8C%E9%9D%A2"><span class="nav-text">冻结界面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%B9%E5%87%BA%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="nav-text">弹出对话框</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Alert"><span class="nav-text">Alert</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Confirm"><span class="nav-text">Confirm</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Prompt"><span class="nav-text">Prompt</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AA%97%E5%8F%A3"><span class="nav-text">窗口</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F"><span class="nav-text">获取窗口大小</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%94%B9%E5%8F%98%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F"><span class="nav-text">改变窗口大小</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%AA%97%E5%8F%A3%E6%A0%87%E9%A2%98"><span class="nav-text">获取当前窗口标题</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%AA%97%E5%8F%A3%E7%9A%84url%E5%9C%B0%E5%9D%80"><span class="nav-text">获取当前窗口的url地址</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%88%AA%E5%B1%8F"><span class="nav-text">截屏</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%8B%E6%9C%BA%E6%A8%A1%E5%BC%8F"><span class="nav-text">手机模式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="nav-text">上传文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Xpath%E9%80%89%E6%8B%A9%E5%99%A8"><span class="nav-text">Xpath选择器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E9%80%89%E6%8B%A9"><span class="nav-text">绝对路径选择</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84%E9%80%89%E6%8B%A9"><span class="nav-text">相对路径选择</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-text">通配符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9-1"><span class="nav-text">根据属性选择</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E5%80%BC%E5%8C%85%E5%90%AB%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">属性值包含字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89%E6%AC%A1%E5%BA%8F%E9%80%89%E6%8B%A9"><span class="nav-text">按次序选择</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%90%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%AC%AC%E5%87%A0%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="nav-text">某类型的第几个元素</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%90%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%80%92%E6%95%B0%E7%AC%AC%E5%87%A0%E4%B8%AA%E5%AD%90%E5%85%83%E7%B4%A0"><span class="nav-text">某类型的倒数第几个子元素</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E9%80%89%E6%8B%A9"><span class="nav-text">范围选择</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E9%80%89%E6%8B%A9%E5%92%8C%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9"><span class="nav-text">组选择和兄弟节点</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%84%E9%80%89%E6%8B%A9"><span class="nav-text">组选择</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E7%88%B6%E8%8A%82%E7%82%B9"><span class="nav-text">选择父节点</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9-1"><span class="nav-text">兄弟节点选择</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#selenium-%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-text">selenium 注意点</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2022.04.28</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">Charmersix</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
